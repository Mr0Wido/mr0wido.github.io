<!DOCTYPE html>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="This is my personal website. The purpose of the Website is to assist and monitor my own development.">
<meta name="google-site-verification" content="NeMnHGyDeeJqt9s_pg03TI1foYUOvLwrHreqLj_mgRE">
<meta name="language" content="en">

<!-- css -->
<link rel="shortcut icon" href="/assets/img/favicon.ico" type="ico">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



<title>TryHackMe - Vulnversity - Mr0Wido's Blog</title>



<!-- Script -->
<script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>
<script src="https://kit.fontawesome.com/d54796acd1.js" crossorigin="anonymous"></script>





    <title>TryHackMe - Vulnversity - Mr0Wido's Blog</title>
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css">
  </head>
  <body>
    <header class="site-header">
  <a class="site-logo" href="/"> <img src="/assets/img/icon-4.png" alt="logo"></a>
  <div class="site-title">
    <a href="http://localhost:4000">Mr0Wido's Blog</a>
  </div>
  <nav class="site-nav">
    <ul class="site-nav__list">
      <li class="site-nav__item">
        <a class="site-nav__link " href="/">Home</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/whoami/">Whoami</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/posts/">Posts</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/projects/">Projects</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/cv/">CV</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/categories/">Categories</a>
      </li>
      <li class="site-nav__item">
        <div class="search">
          <input type="text" id="search-input" placeholder="Search...">
          <i class="fas fa-search"></i>
          <ul id="results-container"></ul>
        </div>
      </li>
    </ul>
  </nav>
</header>


<!-- 360 to 980 -->
<header class="header-mobile">
  <div class="header-inner clearfix">
    <div class="nav-btn nav-slider">
      <i class="fa-solid fa-bars"></i>
    </div>
    <a class="site-logo" href="/"> <img src="/assets/img/icon-4.png" alt="logo"></a>
    <div class="site-title">
      <a href="http://localhost:4000">Mr0Wido's Blog</a>
    </div>
  </div>
</header>
<nav class="sidebar">
  <div class="nav-header">
    <div class="nav-search">
      <div class="search">
        <i class="fas fa-search"></i>
        <input type="search" name="search" id="search-input" placeholder="Search...">
        <ul id="results-container"></ul>
      </div>
    </div>
  </div>
  <ul class="nav-categories ul-base">
    <li><a class="site-nav__link " href="/">Home</a></li>
    <li><a class="site-nav__link " href="/whoami/">Whoami</a></li>
    <li><a class="site-nav__link " href="/posts/">Posts</a></li>
    <li><a class="site-nav__link " href="/projects/">Projects</a></li>
    <li><a class="site-nav__link " href="/cv/">CV</a></li>
    <li><a class="site-nav__link " href="/categories/">Categories</a></li>
  </ul>
  <ul class="social ul-base">
    <li><a href="https://twitter.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i></a></li>
    <li><a href="https://instagram.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i></a></li>
    <li><a href="https://www.linkedin.com/in/" itemprop="sameAs" rel="nofollow noopener noreferrer me" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i></a></li>
    <li><a href="https://github.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i></a></li>
  </ul>
  <div class="copyright">
    <span> © Copyright 2023 Mr0Wido's Blog | Powered by Jekyll | <a href="/tos/">Terms of Service</a> | <a href="/disclaimer/">Disclaimer</a></span>
  </div>
</nav>
<div class="overlay"></div>
    
    <div class="container-default">
      <div class="content-container">
        <main class="default">
          <div class="post">
  <h1 class="post__title">TryHackMe - Vulnversity</h1>
  <div class="post__content">
    <p>This is an easy CTF. Let’s start.</p>

<p><br></p>

<h2 id="1-deploy-the-machine">1. Deploy the machine</h2>

<p>Connect to our network and deploy this machine. If you are unsure on how to get connected, complete the OpenVPN room first.</p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="2-reconnaissance">2. Reconnaissance</h2>

<p>Now that you’ve found the code for the backdoor, it’s time to analyse it.
Gather information about this machine using a network scanning tool called <code class="language-plaintext highlighter-rouge">nmap</code>.</p>

<p><br></p>

<h3 id="21-scan-the-box-how-many-ports-are-open">2.1 Scan the box, how many ports are open?</h3>

<p>Let’s find out how many ports are open on the target with a simple <code class="language-plaintext highlighter-rouge">nmap</code> scan.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nmap -sSV 10.10.56.244
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/vulnversity/nmap.png" alt="nmap"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">6</code></strong></p>

<p><br></p>

<h3 id="22-what-version-of-the-squid-proxy-is-running-on-the-machine">2.2 What version of the squid proxy is running on the machine?</h3>

<p>As you may have noticed from the previous question, squid proxy is http-proxy running on port <code class="language-plaintext highlighter-rouge">3128/tcp</code>.</p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">3.5.12</code></strong></p>

<p><br></p>

<h3 id="23-how-many-ports-will-nmap-scan-if-the-flag--p-400-was-used">2.3 How many ports will nmap scan if the flag -p-400 was used?</h3>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">400</code></strong></p>

<p><br></p>

<h3 id="24-using-the-nmap-flag--n-what-will-it-not-resolve">2.4 Using the nmap flag -n what will it not resolve?</h3>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">DNS</code></strong></p>

<p><br></p>

<h3 id="25-what-is-the-most-likely-operating-system-this-machine-is-running">2.5 What is the most likely operating system this machine is running?</h3>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">ubuntu</code></strong></p>

<p><br></p>

<h3 id="26-what-port-is-the-web-server-running-on">2.6 What port is the web server running on?</h3>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">3333</code></strong></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="3-locating-directories-using-gobuster">3. Locating directories using GoBuster</h2>

<p>Using a fast directory discovery tool called GoBuster you will locate a directory that you can use to upload a shell to.</p>

<p><br></p>

<h3 id="31-what-is-the-directory-that-has-an-upload-form-page">3.1 What is the directory that has an upload form page?</h3>

<p>Now, let’s do a directory scan using <code class="language-plaintext highlighter-rouge">gobuster</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`$ gobuster dir -u http://10.10.56.244:3333/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/vulnversity/gobuster.png" alt="gobuster"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">/internal/</code></strong></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="4-compromise-the-webserver">4. Compromise the webserver</h2>

<p>Now you have found a form to upload files, we can leverage this to upload and execute our payload that will lead to compromising the web server.</p>

<p><br></p>

<h3 id="41-what-common-file-type-which-youd-want-to-upload-to-exploit-the-server-is-blocked-try-a-couple-to-find-out">4.1 What common file type, which you’d want to upload to exploit the server, is blocked? Try a couple to find out.</h3>

<p>I downloaded and tried pentest monkey’s php-reverse-shell.php file, but it didn’t upload.
<a href="https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php" rel="external nofollow noopener" target="_blank">php-reverse-shell.php</a></p>

<p><img src="/assets/img/tryhackme/vulnversity/error.png" alt="error"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">.php</code></strong></p>

<p><br></p>

<h3 id="42-run-this-attack-what-extension-is-allowed">4.2 Run this attack, what extension is allowed?</h3>

<p>Since the .php extension does not work here, we need to try other php extensions instead. If you want, you can do it manually or by using burp suite as tryhackme explained, I don’t see the need to use burp suite for now.</p>

<p><img src="/assets/img/tryhackme/vulnversity/success.png" alt="success"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">.phtml</code></strong></p>

<p><br></p>

<h3 id="43-what-is-the-name-of-the-user-who-manages-the-webserver">4.3 What is the name of the user who manages the webserver?</h3>

<p>Now we edit the reverse shell (we adjust the ip and port parts according to ourselves) and upload it.</p>

<p><img src="/assets/img/tryhackme/vulnversity/set.png" alt="set"></p>

<p>Then we open a listener for the port we wrote in the shell using <code class="language-plaintext highlighter-rouge">netcat</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nc -nlvp 4444
</code></pre></div></div>

<p>Then we visit the shell that we uploaded to the target site.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ http://10.10.56.244:3333/internal/uploads/shell.phtml
</code></pre></div></div>

<p>And we are inside.</p>

<p><img src="/assets/img/tryhackme/vulnversity/in.png" alt="in"></p>

<p>Now, to find out who the user is, we go to the <code class="language-plaintext highlighter-rouge">/home</code> directory and list the files using the <code class="language-plaintext highlighter-rouge">ls -la</code> command. There should be a folder with the user’s name here.</p>

<p><img src="/assets/img/tryhackme/vulnversity/bill.png" alt="bill"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">bill</code></strong></p>

<p><br></p>

<h3 id="44-what-is-the-user-flag">4.4 What is the user flag?</h3>

<p>Now we open the <code class="language-plaintext highlighter-rouge">user.txt</code> owned by the user, Bill.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat /home/bill/user.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/vulnversity/user-flag.png" alt="user-flag"></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="5-privilege-escalation">5. Privilege Escalation</h2>

<p>Now you have compromised this machine, we are going to escalate our privileges and become the superuser (root).</p>

<p><br></p>

<h3 id="51-on-the-system-search-for-all-suid-files-what-file-stands-out">5.1 On the system, search for all SUID files. What file stands out?</h3>

<p><em>Hint: Use the command: find / -user root -perm -4000 -print 2&gt;/dev/null</em></p>

<p><img src="/assets/img/tryhackme/vulnversity/find.png" alt="find"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">/bin/systemctl</code></strong></p>

<p><br></p>

<h3 id="52-become-root-and-get-the-last-flag-rootroottxt">5.2 Become root and get the last flag (/root/root.txt).</h3>

<p><em>Hint: /bin/systemctl</em></p>

<p>Let’s enter the following codes one by one to raise privileges and access root.txt.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat &gt; /tmp/flag.service &lt;&lt; EOF
&gt; [Service]
&gt; ExecStart=/bin/bash -c "cat /root/root.txt &gt; /tmp/flag.txt"
&gt; [Install]
&gt; WantedBy=multi-user.target
&gt; EOF
$ /bin/systemctl link /tmp/flag.service
$ /bin/systemctl enable --now /tmp/flag.service
$ cat /tmp/flag.txt 
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/vulnversity/root-flag.png" alt="root-flag"></p>

<p><br></p>

<p>It was such a fun CTF. I hope you learned something and had fun too. But that’s it for now till next time take care.</p>

<p><br></p>

  </div>
  <div class="post__footer">
    <p class="post__date">
      <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>  Mar 14, 2023</p>
    <div class="post__categories">
      
      
      <p><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: <a href="/categories/#TryHackMe">TryHackMe</a></p>
            
    </div>      
    
    <div class="post__tags">
      <p class="post__tags-title">
        <span class="post__tags__title"><i class="fas fa-fw fa-tags" aria-hidden="true"></i>Tags: </span>
        <span class="post__tags-container">
          
          <span class="post__tags-item">recon,</span>
          
          <span class="post__tags-item">privesc,</span>
          
          <span class="post__tags-item">webappsec</span>
          
        </span>
      </p>
    </div>
    
  </div>
</div>
<br>


<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    this.page.url = 'http://localhost:4000/tryhackme-vulnversity/';
    this.page.identifier = '/tryhackme-vulnversity';
    
    };

    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://mr0widos-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by Disqus.</a>
</noscript>



        </main>
      </div>
      <div class="author-container">
        


<div itemscope itemtype="https://schema.org/Person" class="author-card">

  
    <div class="author__avatar">
        <img src="/assets/img/avatar.jpg" alt="Mr0Wido's Blog" itemprop="image" class="u-photo">
    </div>
  
  <div class="author__content-head">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am an avid CTF player. I am interested in everything related to technology. I enjoy my time working with computers. Self and constant learner.</p>

        </div>
      
    </div>
  
    <div class="author__urls-wrapper">
      <ul class="author__urls social-icons">
        
          
            
              <li><a href="http://localhost:4000/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
            
          
            
              <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
            
          
            
              <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
            
          
            
              <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
            
          
            
              <li><a href="https://www.linkedin.com/in/furkan-deniz-0b4389267" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
            
          
        
  
        
  
        
          <li>
            <a href="mailto:furkn.dniz@gmail.com" rel="me" class="u-email">
              <meta itemprop="email" content="furkn.dniz@gmail.com">
              <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
            </a>
          </li>
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
      </ul>
    </div>
  </div>
  <div class="author__content-head-medium">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am an avid CTF player. I am interested in everything related to technology. I enjoy my time working with computers. Self and constant learner.</p>

        </div>
      
      <div class="author__urls-wrapper">
        <ul class="author__urls social-icons">
          
            
              
                <li><a href="http://localhost:4000/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
              
            
              
                <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
              
            
              
                <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
              
            
              
                <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
              
            
              
                <li><a href="https://www.linkedin.com/in/furkan-deniz-0b4389267" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
              
            
          
    
          
    
          
            <li>
              <a href="mailto:furkn.dniz@gmail.com" rel="me" class="u-email">
                <meta itemprop="email" content="furkn.dniz@gmail.com">
                <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
              </a>
            </li>
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
        </ul>
      </div>
    </div>
  

  </div>
</div>

      </div>
    </div>

    <div class="container-medium">
      <div class="author-container">
        


<div itemscope itemtype="https://schema.org/Person" class="author-card">

  
    <div class="author__avatar">
        <img src="/assets/img/avatar.jpg" alt="Mr0Wido's Blog" itemprop="image" class="u-photo">
    </div>
  
  <div class="author__content-head">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am an avid CTF player. I am interested in everything related to technology. I enjoy my time working with computers. Self and constant learner.</p>

        </div>
      
    </div>
  
    <div class="author__urls-wrapper">
      <ul class="author__urls social-icons">
        
          
            
              <li><a href="http://localhost:4000/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
            
          
            
              <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
            
          
            
              <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
            
          
            
              <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
            
          
            
              <li><a href="https://www.linkedin.com/in/furkan-deniz-0b4389267" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
            
          
        
  
        
  
        
          <li>
            <a href="mailto:furkn.dniz@gmail.com" rel="me" class="u-email">
              <meta itemprop="email" content="furkn.dniz@gmail.com">
              <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
            </a>
          </li>
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
      </ul>
    </div>
  </div>
  <div class="author__content-head-medium">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am an avid CTF player. I am interested in everything related to technology. I enjoy my time working with computers. Self and constant learner.</p>

        </div>
      
      <div class="author__urls-wrapper">
        <ul class="author__urls social-icons">
          
            
              
                <li><a href="http://localhost:4000/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
              
            
              
                <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
              
            
              
                <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
              
            
              
                <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
              
            
              
                <li><a href="https://www.linkedin.com/in/furkan-deniz-0b4389267" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
              
            
          
    
          
    
          
            <li>
              <a href="mailto:furkn.dniz@gmail.com" rel="me" class="u-email">
                <meta itemprop="email" content="furkn.dniz@gmail.com">
                <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
              </a>
            </li>
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
        </ul>
      </div>
    </div>
  

  </div>
</div>

      </div>
      <div class="content-container">
        <main class="default">
          <div class="post">
  <h1 class="post__title">TryHackMe - Vulnversity</h1>
  <div class="post__content">
    <p>This is an easy CTF. Let’s start.</p>

<p><br></p>

<h2 id="1-deploy-the-machine">1. Deploy the machine</h2>

<p>Connect to our network and deploy this machine. If you are unsure on how to get connected, complete the OpenVPN room first.</p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="2-reconnaissance">2. Reconnaissance</h2>

<p>Now that you’ve found the code for the backdoor, it’s time to analyse it.
Gather information about this machine using a network scanning tool called <code class="language-plaintext highlighter-rouge">nmap</code>.</p>

<p><br></p>

<h3 id="21-scan-the-box-how-many-ports-are-open">2.1 Scan the box, how many ports are open?</h3>

<p>Let’s find out how many ports are open on the target with a simple <code class="language-plaintext highlighter-rouge">nmap</code> scan.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nmap -sSV 10.10.56.244
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/vulnversity/nmap.png" alt="nmap"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">6</code></strong></p>

<p><br></p>

<h3 id="22-what-version-of-the-squid-proxy-is-running-on-the-machine">2.2 What version of the squid proxy is running on the machine?</h3>

<p>As you may have noticed from the previous question, squid proxy is http-proxy running on port <code class="language-plaintext highlighter-rouge">3128/tcp</code>.</p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">3.5.12</code></strong></p>

<p><br></p>

<h3 id="23-how-many-ports-will-nmap-scan-if-the-flag--p-400-was-used">2.3 How many ports will nmap scan if the flag -p-400 was used?</h3>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">400</code></strong></p>

<p><br></p>

<h3 id="24-using-the-nmap-flag--n-what-will-it-not-resolve">2.4 Using the nmap flag -n what will it not resolve?</h3>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">DNS</code></strong></p>

<p><br></p>

<h3 id="25-what-is-the-most-likely-operating-system-this-machine-is-running">2.5 What is the most likely operating system this machine is running?</h3>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">ubuntu</code></strong></p>

<p><br></p>

<h3 id="26-what-port-is-the-web-server-running-on">2.6 What port is the web server running on?</h3>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">3333</code></strong></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="3-locating-directories-using-gobuster">3. Locating directories using GoBuster</h2>

<p>Using a fast directory discovery tool called GoBuster you will locate a directory that you can use to upload a shell to.</p>

<p><br></p>

<h3 id="31-what-is-the-directory-that-has-an-upload-form-page">3.1 What is the directory that has an upload form page?</h3>

<p>Now, let’s do a directory scan using <code class="language-plaintext highlighter-rouge">gobuster</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`$ gobuster dir -u http://10.10.56.244:3333/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/vulnversity/gobuster.png" alt="gobuster"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">/internal/</code></strong></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="4-compromise-the-webserver">4. Compromise the webserver</h2>

<p>Now you have found a form to upload files, we can leverage this to upload and execute our payload that will lead to compromising the web server.</p>

<p><br></p>

<h3 id="41-what-common-file-type-which-youd-want-to-upload-to-exploit-the-server-is-blocked-try-a-couple-to-find-out">4.1 What common file type, which you’d want to upload to exploit the server, is blocked? Try a couple to find out.</h3>

<p>I downloaded and tried pentest monkey’s php-reverse-shell.php file, but it didn’t upload.
<a href="https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php" rel="external nofollow noopener" target="_blank">php-reverse-shell.php</a></p>

<p><img src="/assets/img/tryhackme/vulnversity/error.png" alt="error"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">.php</code></strong></p>

<p><br></p>

<h3 id="42-run-this-attack-what-extension-is-allowed">4.2 Run this attack, what extension is allowed?</h3>

<p>Since the .php extension does not work here, we need to try other php extensions instead. If you want, you can do it manually or by using burp suite as tryhackme explained, I don’t see the need to use burp suite for now.</p>

<p><img src="/assets/img/tryhackme/vulnversity/success.png" alt="success"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">.phtml</code></strong></p>

<p><br></p>

<h3 id="43-what-is-the-name-of-the-user-who-manages-the-webserver">4.3 What is the name of the user who manages the webserver?</h3>

<p>Now we edit the reverse shell (we adjust the ip and port parts according to ourselves) and upload it.</p>

<p><img src="/assets/img/tryhackme/vulnversity/set.png" alt="set"></p>

<p>Then we open a listener for the port we wrote in the shell using <code class="language-plaintext highlighter-rouge">netcat</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nc -nlvp 4444
</code></pre></div></div>

<p>Then we visit the shell that we uploaded to the target site.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ http://10.10.56.244:3333/internal/uploads/shell.phtml
</code></pre></div></div>

<p>And we are inside.</p>

<p><img src="/assets/img/tryhackme/vulnversity/in.png" alt="in"></p>

<p>Now, to find out who the user is, we go to the <code class="language-plaintext highlighter-rouge">/home</code> directory and list the files using the <code class="language-plaintext highlighter-rouge">ls -la</code> command. There should be a folder with the user’s name here.</p>

<p><img src="/assets/img/tryhackme/vulnversity/bill.png" alt="bill"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">bill</code></strong></p>

<p><br></p>

<h3 id="44-what-is-the-user-flag">4.4 What is the user flag?</h3>

<p>Now we open the <code class="language-plaintext highlighter-rouge">user.txt</code> owned by the user, Bill.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat /home/bill/user.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/vulnversity/user-flag.png" alt="user-flag"></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="5-privilege-escalation">5. Privilege Escalation</h2>

<p>Now you have compromised this machine, we are going to escalate our privileges and become the superuser (root).</p>

<p><br></p>

<h3 id="51-on-the-system-search-for-all-suid-files-what-file-stands-out">5.1 On the system, search for all SUID files. What file stands out?</h3>

<p><em>Hint: Use the command: find / -user root -perm -4000 -print 2&gt;/dev/null</em></p>

<p><img src="/assets/img/tryhackme/vulnversity/find.png" alt="find"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">/bin/systemctl</code></strong></p>

<p><br></p>

<h3 id="52-become-root-and-get-the-last-flag-rootroottxt">5.2 Become root and get the last flag (/root/root.txt).</h3>

<p><em>Hint: /bin/systemctl</em></p>

<p>Let’s enter the following codes one by one to raise privileges and access root.txt.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat &gt; /tmp/flag.service &lt;&lt; EOF
&gt; [Service]
&gt; ExecStart=/bin/bash -c "cat /root/root.txt &gt; /tmp/flag.txt"
&gt; [Install]
&gt; WantedBy=multi-user.target
&gt; EOF
$ /bin/systemctl link /tmp/flag.service
$ /bin/systemctl enable --now /tmp/flag.service
$ cat /tmp/flag.txt 
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/vulnversity/root-flag.png" alt="root-flag"></p>

<p><br></p>

<p>It was such a fun CTF. I hope you learned something and had fun too. But that’s it for now till next time take care.</p>

<p><br></p>

  </div>
  <div class="post__footer">
    <p class="post__date">
      <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>  Mar 14, 2023</p>
    <div class="post__categories">
      
      
      <p><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: <a href="/categories/#TryHackMe">TryHackMe</a></p>
            
    </div>      
    
    <div class="post__tags">
      <p class="post__tags-title">
        <span class="post__tags__title"><i class="fas fa-fw fa-tags" aria-hidden="true"></i>Tags: </span>
        <span class="post__tags-container">
          
          <span class="post__tags-item">recon,</span>
          
          <span class="post__tags-item">privesc,</span>
          
          <span class="post__tags-item">webappsec</span>
          
        </span>
      </p>
    </div>
    
  </div>
</div>
<br>


<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    this.page.url = 'http://localhost:4000/tryhackme-vulnversity/';
    this.page.identifier = '/tryhackme-vulnversity';
    
    };

    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://mr0widos-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by Disqus.</a>
</noscript>



        </main>
      </div>
    </div>




    <button onclick="topFunction()" id="myBtn" title="Go to top"><i class="fas fa-chevron-circle-up fa-2x"></i></button>
    <footer>
  <div class="footer">
    © Copyright 2023 Mr0Wido's Blog | Powered by Jekyll | <a href="/tos/">Terms of Service</a> | <a href="/disclaimer/">Disclaimer</a>
  </div>
</footer>

    <!-- script -->
    <script src="/assets/js/nav.js"></script>
    <script src="/assets/js/clip.js"></script>
    <script src="/assets/js/scroll-top.js"></script>
    <script src="/assets/js/search.js"></script>
  </body>
</html>
